

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>retentioneering.core package &mdash; Retentioneering Tools 1.0.0 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="retentioneering.visualization package" href="retentioneering.visualization.html" />
    <link rel="prev" title="retentioneering package" href="retentioneering.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> Retentioneering Tools
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="step_matrix.html">Step_matrix</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="retentioneering.html">Documentation</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="retentioneering.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">retentioneering.core package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-retentioneering.core.base_classes.base_trajectory">retentioneering.core.base_classes.base_trajectory module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-retentioneering.core.clustering">retentioneering.core.clustering module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-retentioneering.core.feature_extraction">retentioneering.core.feature_extraction module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-retentioneering.core.model">retentioneering.core.model module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#retentioneering-core-node-metrics-module">retentioneering.core.node_metrics module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-retentioneering.core.preprocessing">retentioneering.core.preprocessing module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-retentioneering.core.tree_selector">retentioneering.core.tree_selector module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#retentioneering-core-utils-module">retentioneering.core.utils module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-retentioneering.core">Module contents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="retentioneering.visualization.html">retentioneering.visualization package</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="retentioneering.html#module-retentioneering">Module contents</a></li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Retentioneering Tools</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="retentioneering.html">retentioneering package</a> &raquo;</li>
        
      <li>retentioneering.core package</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/retentioneering.core.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="retentioneering-core-package">
<h1>retentioneering.core package<a class="headerlink" href="#retentioneering-core-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-retentioneering.core.base_classes.base_trajectory">
<span id="retentioneering-core-base-classes-base-trajectory-module"></span><h2>retentioneering.core.base_classes.base_trajectory module<a class="headerlink" href="#module-retentioneering.core.base_classes.base_trajectory" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="retentioneering.core.base_classes.base_trajectory.BaseTrajectory">
<em class="property">class </em><code class="sig-prename descclassname">retentioneering.core.base_classes.base_trajectory.</code><code class="sig-name descname">BaseTrajectory</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pandas_obj</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/retentioneering/core/base_classes/base_trajectory.html#BaseTrajectory"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#retentioneering.core.base_classes.base_trajectory.BaseTrajectory" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Trajectory is the basic object in Retentioneering. It is a dataframe consisting of at least three columns which
should be reflected in <code class="docutils literal notranslate"><span class="pre">init_cofig</span></code>: index, event and timestamp.</p>
<dl class="py method">
<dt id="retentioneering.core.base_classes.base_trajectory.BaseTrajectory.get_adjacency">
<code class="sig-name descname">get_adjacency</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span></em>, <em class="sig-param"><span class="n">weight_col</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">norm_type</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/retentioneering/core/base_classes/base_trajectory.html#BaseTrajectory.get_adjacency"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#retentioneering.core.base_classes.base_trajectory.BaseTrajectory.get_adjacency" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates edge graph in the matrix format. Basically this method is similar to
<code class="docutils literal notranslate"><span class="pre">BaseTrajectory.rete.get_edgelist()</span></code> but in different format. Row indeces are <code class="docutils literal notranslate"><span class="pre">event_col</span></code> values, from</p>
<blockquote>
<div><p>which the transition occured, while the row names are <code class="docutils literal notranslate"><span class="pre">event_col</span></code> values, to which the transition occured.
The values are weights of the edges defined with <code class="docutils literal notranslate"><span class="pre">weight_col</span></code>, <code class="docutils literal notranslate"><span class="pre">edge_attributes</span></code> and <code class="docutils literal notranslate"><span class="pre">norm</span></code> parameters.</p>
</div></blockquote>
<dl class="simple">
<dt>weight_col: str, optional, default=None</dt><dd><p>Aggregation column for transitions weighting. To calculate weights as number of transion events leave as
<code class="docutils literal notranslate"><span class="pre">`None</span></code>. To calculate number of unique users passed through given transition
<code class="docutils literal notranslate"><span class="pre">edge_attributes='user_id'</span></code>. For any other aggreagtion, life number of sessions, pass the column name.</p>
</dd>
<dt>norm_type: {None, ‘full’, ‘node’} str, optional, default=None</dt><dd><p>Type of normalization. If <code class="docutils literal notranslate"><span class="pre">None</span></code> return raw number of transtions or other selected aggregation column.
If <code class="docutils literal notranslate"><span class="pre">norm_type='full'</span></code> normalization</p>
</dd>
</dl>
<p>Dataframe with number of columns and rows equal to unique number of <code class="docutils literal notranslate"><span class="pre">event_col</span></code> values.</p>
<p>pd.DataFrame</p>
</dd></dl>

<dl class="py method">
<dt id="retentioneering.core.base_classes.base_trajectory.BaseTrajectory.get_edgelist">
<code class="sig-name descname">get_edgelist</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span></em>, <em class="sig-param"><span class="n">weight_col</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">norm_type</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">edge_attributes</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/retentioneering/core/base_classes/base_trajectory.html#BaseTrajectory.get_edgelist"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#retentioneering.core.base_classes.base_trajectory.BaseTrajectory.get_edgelist" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates weighted table of the transitions between events.</p>
<p>edge_attributes
weight_col: str, optional, default=None</p>
<blockquote>
<div><p>Aggregation column for transitions weighting. To calculate weights as number of transion events leave as
<code class="docutils literal notranslate"><span class="pre">`None</span></code>. To calculate number of unique users passed through given transition
<code class="docutils literal notranslate"><span class="pre">edge_attributes='user_id'</span></code>. For any other aggreagtion, life number of sessions, pass the column name.</p>
</div></blockquote>
<dl class="simple">
<dt>norm_type: {None, ‘full’, ‘node’} str, optional, default=None</dt><dd><p>Type of normalization. If <code class="docutils literal notranslate"><span class="pre">None</span></code> return raw number of transtions or other selected aggregation column.
If <code class="docutils literal notranslate"><span class="pre">norm_type='full'</span></code> normalization</p>
</dd>
</dl>
<dl class="simple">
<dt>Dataframe with number of rows equal to all transitions with weight non-zero weight (max is squared number of</dt><dd><p>unique <code class="docutils literal notranslate"><span class="pre">event_col</span></code> values) and the following column structure: <code class="docutils literal notranslate"><span class="pre">source_node</span></code>, <code class="docutils literal notranslate"><span class="pre">target_node</span></code> and
<code class="docutils literal notranslate"><span class="pre">edge_weight</span></code>.</p>
</dd>
</dl>
<p>pd.DataFrame</p>
</dd></dl>

<dl class="py method">
<dt id="retentioneering.core.base_classes.base_trajectory.BaseTrajectory.get_shift">
<code class="sig-name descname">get_shift</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span></em>, <em class="sig-param"><span class="n">index_col</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">event_col</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/retentioneering/core/base_classes/base_trajectory.html#BaseTrajectory.get_shift"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#retentioneering.core.base_classes.base_trajectory.BaseTrajectory.get_shift" title="Permalink to this definition">¶</a></dt>
<dd><p>index_col
event_col</p>
</dd></dl>

<dl class="py method">
<dt id="retentioneering.core.base_classes.base_trajectory.BaseTrajectory.graph">
<code class="sig-name descname">graph</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span></em>, <em class="sig-param"><span class="n">targets</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">weight_col</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">event_col</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">node_weights</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">norm_type</span><span class="o">=</span><span class="default_value">'full'</span></em>, <em class="sig-param"><span class="n">thresh</span><span class="o">=</span><span class="default_value">0.01</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/retentioneering/core/base_classes/base_trajectory.html#BaseTrajectory.graph"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#retentioneering.core.base_classes.base_trajectory.BaseTrajectory.graph" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Create interactive graph visualization. Each node is a unique <code class="docutils literal notranslate"><span class="pre">event_col</span></code> value, edges are transitions between</dt><dd><dl class="simple">
<dt>events and edge weights are calculated metrics. By default, it is a percentage of unique users that have passed</dt><dd><dl class="simple">
<dt>though a particular edge visualized with the edge thickness. Node sizes are  Graph loop is a transition to the</dt><dd><p>same node, which may happen if users encountered multiple errors or made any action at least twice.</p>
</dd>
</dl>
</dd>
</dl>
</dd>
<dt>Graph nodes are movable on canvas which helps to visualize user trajectories but is also a cumbersome process to</dt><dd><p>place all the nodes so it forms a story.</p>
</dd>
</dl>
<p>That is why IFrame object also has a download button. By pressing it, a JSON configuration file with all the
node parameters is downloaded. It contains node names, their positions, relative sizes and types. It it used as
<code class="docutils literal notranslate"><span class="pre">layout_dump</span></code> parameter for layout configuration. Finally, show weights toggle shows and hides edge weights.</p>
<p>event_col
norm_type
node_weights
weight_col
node_params: dict, optional</p>
<blockquote>
<div><p>Event mapping describing which nodes or edges should be highlighted by different colors for better
visualisation. Dictionary keys are <code class="docutils literal notranslate"><span class="pre">event_col</span></code> values, while keys have the following possible values:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">bad_target</span></code>: highlights node and all incoming edges with red color;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nice_target</span></code>: highlights node and all incoming edges with green color;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">bad_node</span></code>: highlights node with red color;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nice_node</span></code>: highlights node with green color;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">source</span></code>: highlights node and all outgoing edges with yellow color.</p></li>
</ul>
</div></blockquote>
<p>Example <code class="docutils literal notranslate"><span class="pre">node_params</span></code> is shown below:
<a href="#id1"><span class="problematic" id="id2">``</span></a>`
{</p>
<blockquote>
<div><p>‘lost’: ‘bad_target’,
‘purchased’: ‘nice_target’,
‘onboarding_welcome_screen’: ‘source’,
‘choose_login_type’: ‘nice_node’,
‘accept_privacy_policy’: ‘bad_node’,</p>
</div></blockquote>
<p>If <code class="docutils literal notranslate"><span class="pre">node_params=None</span></code>, it will be constructed from <code class="docutils literal notranslate"><span class="pre">retention_config</span></code> variable, so that:
<a href="#id3"><span class="problematic" id="id4">``</span></a>`
{</p>
<blockquote>
<div><p>‘positive_target_event’: ‘nice_target’,
‘negative_target_event’: ‘bad_target’,
‘source_event’: ‘source’,</p>
</div></blockquote>
<p>Default: <code class="docutils literal notranslate"><span class="pre">None</span></code></p>
</div></blockquote>
<dl class="simple">
<dt>thresh: float, optional</dt><dd><p>Minimal edge weight value to be rendered on a graph. If a node has no edges of the weight &gt;= <code class="docutils literal notranslate"><span class="pre">thresh</span></code>,
then it is not shown on a graph. It is used to filter out rare event and not to clutter visualization. If
you want to preserve some of the nodes regardless of <code class="docutils literal notranslate"><span class="pre">thresh</span></code> value, please use <code class="docutils literal notranslate"><span class="pre">targets</span></code> parameter.
Default: <code class="docutils literal notranslate"><span class="pre">0.05</span></code></p>
</dd>
<dt>targets: list, optional</dt><dd><p>List of nodes which will ignore <code class="docutils literal notranslate"><span class="pre">thresh</span></code> parameter.</p>
</dd>
<dt>show_percent: bool, optional</dt><dd><p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, then all edge weights are converted to percents by multiplying by 100 and adding percentage
sign. Default: <code class="docutils literal notranslate"><span class="pre">True</span></code></p>
</dd>
<dt>interactive: bool, optional</dt><dd><p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, then plots graph visualization in interactive session (Jupyter notebook). Default: <code class="docutils literal notranslate"><span class="pre">True</span></code></p>
</dd>
<dt>layout_dump: str, optional</dt><dd><p>Path to layout configuration file relative to current directory. If defined, uses configuration file as a
graph layout. Default: <code class="docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
<dt>width: int, optional</dt><dd><p>Width of plot in pixels. Default: <code class="docutils literal notranslate"><span class="pre">500</span></code></p>
</dd>
<dt>height: int, optional</dt><dd><p>Height of plot in pixels. Default: <code class="docutils literal notranslate"><span class="pre">500</span></code></p>
</dd>
<dt>kwargs: optional</dt><dd><p>Other parameters for <code class="docutils literal notranslate"><span class="pre">BaseTrajectory.rete.get_edgelist()</span></code></p>
</dd>
</dl>
<p>Plots IFrame graph of <code class="docutils literal notranslate"><span class="pre">width</span></code> and <code class="docutils literal notranslate"><span class="pre">height</span></code> size.
Saves webpage with JS graph visualization to <code class="docutils literal notranslate"><span class="pre">retention_config.experiments_folder</span></code>.</p>
<p>Renders IFrame object in case of <code class="docutils literal notranslate"><span class="pre">interactive=True</span></code> and saves graph visualization as HTML in
<code class="docutils literal notranslate"><span class="pre">experiments_folder</span></code> of <code class="docutils literal notranslate"><span class="pre">retention_config</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt id="retentioneering.core.base_classes.base_trajectory.BaseTrajectory.plot_graph">
<code class="sig-name descname">plot_graph</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span></em>, <em class="sig-param"><span class="n">node_params</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">weight_col</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">event_col</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">node_weights</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">norm_type</span><span class="o">=</span><span class="default_value">'full'</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/retentioneering/core/base_classes/base_trajectory.html#BaseTrajectory.plot_graph"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#retentioneering.core.base_classes.base_trajectory.BaseTrajectory.plot_graph" title="Permalink to this definition">¶</a></dt>
<dd><p><strong>* DEPRICATED *</strong>
<strong>* WILL BE REMOVED IN NEXT UPDATES *</strong>
<strong>* USE rete.graph instead *</strong></p>
<dl class="simple">
<dt>Create interactive graph visualization. Each node is a unique <code class="docutils literal notranslate"><span class="pre">event_col</span></code> value, edges are transitions between</dt><dd><dl class="simple">
<dt>events and edge weights are calculated metrics. By default, it is a percentage of unique users that have passed</dt><dd><dl class="simple">
<dt>though a particular edge visualized with the edge thickness. Node sizes are  Graph loop is a transition to the</dt><dd><p>same node, which may happen if users encountered multiple errors or made any action at least twice.</p>
</dd>
</dl>
</dd>
</dl>
</dd>
<dt>Graph nodes are movable on canvas which helps to visualize user trajectories but is also a cumbersome process to</dt><dd><p>place all the nodes so it forms a story.</p>
</dd>
</dl>
<p>That is why IFrame object also has a download button. By pressing it, a JSON configuration file with all the
node parameters is downloaded. It contains node names, their positions, relative sizes and types. It it used as
<code class="docutils literal notranslate"><span class="pre">layout_dump</span></code> parameter for layout configuration. Finally, show weights toggle shows and hides edge weights.
Parameters
——–
event_col
norm_type
node_weights
weight_col
node_params: dict, optional</p>
<blockquote>
<div><p>Event mapping describing which nodes or edges should be highlighted by different colors for better
visualisation. Dictionary keys are <code class="docutils literal notranslate"><span class="pre">event_col</span></code> values, while keys have the following possible values:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">bad_target</span></code>: highlights node and all incoming edges with red color;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nice_target</span></code>: highlights node and all incoming edges with green color;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">bad_node</span></code>: highlights node with red color;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nice_node</span></code>: highlights node with green color;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">source</span></code>: highlights node and all outgoing edges with yellow color.</p></li>
</ul>
</div></blockquote>
<p>Example <code class="docutils literal notranslate"><span class="pre">node_params</span></code> is shown below:
<a href="#id5"><span class="problematic" id="id6">``</span></a>`
{</p>
<blockquote>
<div><p>‘lost’: ‘bad_target’,
‘purchased’: ‘nice_target’,
‘onboarding_welcome_screen’: ‘source’,
‘choose_login_type’: ‘nice_node’,
‘accept_privacy_policy’: ‘bad_node’,</p>
</div></blockquote>
<p>If <code class="docutils literal notranslate"><span class="pre">node_params=None</span></code>, it will be constructed from <code class="docutils literal notranslate"><span class="pre">retention_config</span></code> variable, so that:
<a href="#id7"><span class="problematic" id="id8">``</span></a>`
{</p>
<blockquote>
<div><p>‘positive_target_event’: ‘nice_target’,
‘negative_target_event’: ‘bad_target’,
‘source_event’: ‘source’,</p>
</div></blockquote>
<p>Default: <code class="docutils literal notranslate"><span class="pre">None</span></code></p>
</div></blockquote>
<dl class="simple">
<dt>thresh: float, optional</dt><dd><p>Minimal edge weight value to be rendered on a graph. If a node has no edges of the weight &gt;= <code class="docutils literal notranslate"><span class="pre">thresh</span></code>,
then it is not shown on a graph. It is used to filter out rare event and not to clutter visualization. If
you want to preserve some of the nodes regardless of <code class="docutils literal notranslate"><span class="pre">thresh</span></code> value, please use <code class="docutils literal notranslate"><span class="pre">targets</span></code> parameter.
Default: <code class="docutils literal notranslate"><span class="pre">0.05</span></code></p>
</dd>
<dt>targets: list, optional</dt><dd><p>List of nodes which will ignore <code class="docutils literal notranslate"><span class="pre">thresh</span></code> parameter.</p>
</dd>
<dt>show_percent: bool, optional</dt><dd><p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, then all edge weights are converted to percents by multiplying by 100 and adding percentage
sign. Default: <code class="docutils literal notranslate"><span class="pre">True</span></code></p>
</dd>
<dt>interactive: bool, optional</dt><dd><p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, then plots graph visualization in interactive session (Jupyter notebook). Default: <code class="docutils literal notranslate"><span class="pre">True</span></code></p>
</dd>
<dt>layout_dump: str, optional</dt><dd><p>Path to layout configuration file relative to current directory. If defined, uses configuration file as a
graph layout. Default: <code class="docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
<dt>width: int, optional</dt><dd><p>Width of plot in pixels. Default: <code class="docutils literal notranslate"><span class="pre">500</span></code></p>
</dd>
<dt>height: int, optional</dt><dd><p>Height of plot in pixels. Default: <code class="docutils literal notranslate"><span class="pre">500</span></code></p>
</dd>
<dt>kwargs: optional</dt><dd><p>Other parameters for <code class="docutils literal notranslate"><span class="pre">BaseTrajectory.rete.get_edgelist()</span></code></p>
</dd>
</dl>
<p>Plots IFrame graph of <code class="docutils literal notranslate"><span class="pre">width</span></code> and <code class="docutils literal notranslate"><span class="pre">height</span></code> size.
Saves webpage with JS graph visualization to <code class="docutils literal notranslate"><span class="pre">retention_config.experiments_folder</span></code>.
Return type
——-
Renders IFrame object in case of <code class="docutils literal notranslate"><span class="pre">interactive=True</span></code> and saves graph visualization as HTML in
<code class="docutils literal notranslate"><span class="pre">experiments_folder</span></code> of <code class="docutils literal notranslate"><span class="pre">retention_config</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt id="retentioneering.core.base_classes.base_trajectory.BaseTrajectory.split_sessions">
<code class="sig-name descname">split_sessions</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span></em>, <em class="sig-param"><span class="n">by_event</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">thresh</span></em>, <em class="sig-param"><span class="n">eos_event</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">session_col</span><span class="o">=</span><span class="default_value">'session_id'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/retentioneering/core/base_classes/base_trajectory.html#BaseTrajectory.split_sessions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#retentioneering.core.base_classes.base_trajectory.BaseTrajectory.split_sessions" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates <code class="docutils literal notranslate"><span class="pre">session`_id`</span> <span class="pre">column</span> <span class="pre">with</span> <span class="pre">session</span> <span class="pre">rank</span> <span class="pre">for</span> <span class="pre">each</span> <span class="pre">``index_col</span></code> based on time difference between
events. Sessions are automatically defined with time diffrence between events.
Parameters
——–
session_col
by_event
thresh: int</p>
<blockquote>
<div><p>Minimal threshold in seconds between two sessions. Default: <code class="docutils literal notranslate"><span class="pre">1800</span></code> or 30 min</p>
</div></blockquote>
<dl class="simple">
<dt>eos_event:</dt><dd><p>If not <code class="docutils literal notranslate"><span class="pre">None</span></code> specified event name will be added at the and of each session</p>
</dd>
</dl>
<p>Original Dataframe with <code class="docutils literal notranslate"><span class="pre">session_id</span></code> column in dataset.
Return type
——-
pd.DataFrame</p>
</dd></dl>

<dl class="py method">
<dt id="retentioneering.core.base_classes.base_trajectory.BaseTrajectory.step_matrix">
<code class="sig-name descname">step_matrix</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span></em>, <em class="sig-param"><span class="n">max_steps</span><span class="o">=</span><span class="default_value">30</span></em>, <em class="sig-param"><span class="n">weight_col</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">targets</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">accumulated</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">sorting</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">thresh</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">centered</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">groups</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">precision</span><span class="o">=</span><span class="default_value">2</span></em>, <em class="sig-param"><span class="n">show_plot</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/retentioneering/core/base_classes/base_trajectory.html#BaseTrajectory.step_matrix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#retentioneering.core.base_classes.base_trajectory.BaseTrajectory.step_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots heatmap with distribution of users over session steps ordered by event name. Matrix rows are event names,
columns are aligned user trajectory step numbers and the values are shares of users. A given entry means that at</p>
<blockquote>
<div><p>a particular number step x% of users encountered a specific event.</p>
</div></blockquote>
<p>centered
accumulated
thresh
accumulate_targets
targets
index_col
max_steps: int, optional</p>
<blockquote>
<div><p>Maximum number of steps in trajectory to include. Depending on <code class="docutils literal notranslate"><span class="pre">reverse</span></code> parameter value, the steps are
counted from the beginning of trajectories if <code class="docutils literal notranslate"><span class="pre">reverse=False</span></code>, or from the end otherwise.</p>
</div></blockquote>
<dl>
<dt>plot_type: bool, optional</dt><dd><p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, then plots step matrix in interactive session (Jupyter notebook). Default: <code class="docutils literal notranslate"><span class="pre">True</span></code></p>
</dd>
<dt>thr: float, optional</dt><dd><p>Used to prune matrix and display only the rows with at least one value &gt;= <code class="docutils literal notranslate"><span class="pre">thr</span></code>. Default: <code class="docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
<dt>reverse: str or list, optional</dt><dd><p>This parameter is used to display reversed matrix from target events towards the beginning of trajectories.
Range of possible values:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">None</span></code>: displays default step matrix from the start of trajectories. Uses all the user trajectories.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'pos'</span></code>: displays reverse step matrix in such a way that the first column is the</p></li>
</ul>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">positive_target_event</span></code> share, which is always 1, and the following columns reflect the share of users</dt><dd><dl class="simple">
<dt>on final steps before reaching the target. Uses only those trajectories, which ended up having at least</dt><dd><p>one <code class="docutils literal notranslate"><span class="pre">positive_target_event</span></code> in trajectory.</p>
</dd>
</dl>
</dd>
</dl>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">'neg'</span></code>: same as <code class="docutils literal notranslate"><span class="pre">pos</span></code> but for <code class="docutils literal notranslate"><span class="pre">negative_target_event</span></code>. Uses only those trajectories, which</p></li>
</ul>
<p>ended up having at least one <code class="docutils literal notranslate"><span class="pre">negative_target_event</span></code> in trajectory.
- <code class="docutils literal notranslate"><span class="pre">['pos',</span> <span class="pre">'neg']</span></code>: combination of <code class="docutils literal notranslate"><span class="pre">pos</span></code> and <code class="docutils literal notranslate"><span class="pre">neg</span></code> options, first column has only target events.
Uses all the trajectories with target events inside.</p>
</div></blockquote>
<p>Default: <code class="docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
<dt>sorting: bool, optional</dt><dd><p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, then automatically places elements with highest values in top. Rows are sorted in such a way
that the first one has highest first column value, second row has the highest second column value,besides
already used first value, etc. With this sorting you may see a dominant trajectory as a diagonal.
Default: <code class="docutils literal notranslate"><span class="pre">True</span></code></p>
</dd>
<dt>weight_col: str, optional</dt><dd><p>Aggregation column for edge weighting. For instance, you may set it to the same value as in <code class="docutils literal notranslate"><span class="pre">index_col</span></code>
and define <code class="docutils literal notranslate"><span class="pre">edge_attributes='users_unique'</span></code> to calculate unique users passed through edge.
Default: <code class="docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
<p>Dataframe with <code class="docutils literal notranslate"><span class="pre">max_steps</span></code> number of columns and len(event_col.unique) number of rows at max, or less if used
<code class="docutils literal notranslate"><span class="pre">thr</span></code> &gt; 0.
Return type
——-
pd.DataFrame</p>
</dd></dl>

<dl class="py method">
<dt id="retentioneering.core.base_classes.base_trajectory.BaseTrajectory.step_matrix_values">
<em class="property">static </em><code class="sig-name descname">step_matrix_values</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span></em>, <em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">weight_col</span></em>, <em class="sig-param"><span class="n">event_col</span></em>, <em class="sig-param"><span class="n">time_col</span></em>, <em class="sig-param"><span class="n">targets</span></em>, <em class="sig-param"><span class="n">accumulated</span></em>, <em class="sig-param"><span class="n">centered</span></em>, <em class="sig-param"><span class="n">max_steps</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/retentioneering/core/base_classes/base_trajectory.html#BaseTrajectory.step_matrix_values"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#retentioneering.core.base_classes.base_trajectory.BaseTrajectory.step_matrix_values" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-retentioneering.core.clustering">
<span id="retentioneering-core-clustering-module"></span><h2>retentioneering.core.clustering module<a class="headerlink" href="#module-retentioneering.core.clustering" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="retentioneering.core.clustering.GMM">
<code class="sig-prename descclassname">retentioneering.core.clustering.</code><code class="sig-name descname">GMM</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">max_n_clusters</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">use_csi</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">random_state</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/retentioneering/core/clustering.html#GMM"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#retentioneering.core.clustering.GMM" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds cluster of users in data using Gaussian Mixture Models.</p>
<dl class="simple">
<dt>data: pd.DataFrame</dt><dd><p>Dataframe with features for clustering indexed as in <code class="docutils literal notranslate"><span class="pre">retention_config.index_col</span></code></p>
</dd>
<dt>max_n_clusters: int, optional</dt><dd><p>Maximal number of clusters for automatic selection for number of clusters. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, then uses <code class="docutils literal notranslate"><span class="pre">`n_clusters</span></code> from arguments. Default: <cite>None``</cite></p>
</dd>
<dt>use_csi: bool, optional</dt><dd><p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, then cluster stability index will be calculated. IMPORTANT: it may take a lot of time. Default: <code class="docutils literal notranslate"><span class="pre">True</span></code></p>
</dd>
<dt>random_state: int, optional</dt><dd><p>Random state for GaussianMixture clusterer.</p>
</dd>
<dt>kwargs: optional</dt><dd><p>Parameters for <code class="docutils literal notranslate"><span class="pre">sklearn.mixture.GaussianMixture</span></code></p>
</dd>
</dl>
<p>Array of clusters</p>
<p>np.array</p>
</dd></dl>

<dl class="py function">
<dt id="retentioneering.core.clustering.aggregate_cl">
<code class="sig-prename descclassname">retentioneering.core.clustering.</code><code class="sig-name descname">aggregate_cl</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">cl</span></em>, <em class="sig-param"><span class="n">max_cl_number</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/retentioneering/core/clustering.html#aggregate_cl"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#retentioneering.core.clustering.aggregate_cl" title="Permalink to this definition">¶</a></dt>
<dd><p>Aggregate small clusters to one, based on <code class="docutils literal notranslate"><span class="pre">max_cl_number</span></code>.
Usually it is used for visualization purposes because large number of different colors is hard to distinct.</p>
<dl class="simple">
<dt>cl: ndarray</dt><dd><p>Results of clustering.</p>
</dd>
<dt>max_cl_number: int</dt><dd><p>Maximum number of unique clusters.</p>
</dd>
</dl>
<p>Clustering with merged to -1 small clusters.</p>
<p>ndarray</p>
</dd></dl>

<dl class="py function">
<dt id="retentioneering.core.clustering.calc_all_metrics">
<code class="sig-prename descclassname">retentioneering.core.clustering.</code><code class="sig-name descname">calc_all_metrics</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">km</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/retentioneering/core/clustering.html#calc_all_metrics"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#retentioneering.core.clustering.calc_all_metrics" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates all quality metrics: Cluster Stability Index, Silhouette score, Homogeneity, distances for clustering.</p>
<dl class="simple">
<dt>data: pd.DataFrame</dt><dd><p>Dataframe with features for clustering indexed as in <code class="docutils literal notranslate"><span class="pre">retention_config.index_col</span></code></p>
</dd>
<dt>km:</dt><dd><p>Already fitted clusterer.</p>
</dd>
</dl>
<p>Metrics scores</p>
<p>Dict</p>
</dd></dl>

<dl class="py function">
<dt id="retentioneering.core.clustering.calc_mean_dist_from_center">
<code class="sig-prename descclassname">retentioneering.core.clustering.</code><code class="sig-name descname">calc_mean_dist_from_center</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">km</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/retentioneering/core/clustering.html#calc_mean_dist_from_center"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#retentioneering.core.clustering.calc_mean_dist_from_center" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates mean distance from cluster centers. Note that it will be calculated only for KMeans and GMM, because DBSCAN may have ambiguous form of clusters.</p>
<dl class="simple">
<dt>data: pd.DataFrame</dt><dd><p>Dataframe with features for clustering indexed as in <code class="docutils literal notranslate"><span class="pre">retention_config.index_col</span></code></p>
</dd>
<dt>km:</dt><dd><p>Already fitted clusterer.</p>
</dd>
</dl>
<p>Mapping of clusters names to mean distance from cluster centers.</p>
<p>Dict</p>
</dd></dl>

<dl class="py function">
<dt id="retentioneering.core.clustering.calc_mean_pd">
<code class="sig-prename descclassname">retentioneering.core.clustering.</code><code class="sig-name descname">calc_mean_pd</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">cl</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/retentioneering/core/clustering.html#calc_mean_pd"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#retentioneering.core.clustering.calc_mean_pd" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates mean pairwise distance inside clusters.</p>
<dl class="simple">
<dt>data: pd.DataFrame</dt><dd><p>Dataframe with features for clustering indexed as in <code class="docutils literal notranslate"><span class="pre">retention_config.index_col</span></code></p>
</dd>
<dt>cl:</dt><dd><p>Results of clustering.</p>
</dd>
</dl>
<p>Mapping of clusters names to pairwise distance inside clusters.</p>
<p>Dict</p>
</dd></dl>

<dl class="py function">
<dt id="retentioneering.core.clustering.cluster_stability_index">
<code class="sig-prename descclassname">retentioneering.core.clustering.</code><code class="sig-name descname">cluster_stability_index</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">clusterer</span></em>, <em class="sig-param"><span class="n">base_clusterer</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">n_samples</span><span class="o">=</span><span class="default_value">10</span></em>, <em class="sig-param"><span class="n">frac</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">sample_size</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">replace</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">weights</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">random_state</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/retentioneering/core/clustering.html#cluster_stability_index"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#retentioneering.core.clustering.cluster_stability_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates cluster stability index: rate of random data subsamples with unchanged clustering.</p>
<dl class="simple">
<dt>data: pd.DataFrame</dt><dd><p>Dataframe with features for clustering indexed as in <code class="docutils literal notranslate"><span class="pre">retention_config.index_col</span></code></p>
</dd>
<dt>clusterer: sklearn clusterer class</dt><dd><p>For instance, <code class="docutils literal notranslate"><span class="pre">sklearn.cluster.KMeans</span></code> or <code class="docutils literal notranslate"><span class="pre">sklearn.mixture.GaussianMixture</span></code></p>
</dd>
<dt>base_clusterer: optional</dt><dd><p>Results of base clustering. Default: <code class="docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
<dt>n_samples: int, optional</dt><dd><p>Number of random subsamples for CSI calculation. Default: <code class="docutils literal notranslate"><span class="pre">10</span></code></p>
</dd>
<dt>frac: int, optional</dt><dd><p>Rate of <code class="docutils literal notranslate"><span class="pre">retention_config.index_col</span></code> values in each subsample relative to input data. Default: <code class="docutils literal notranslate"><span class="pre">1</span></code></p>
</dd>
<dt>sample_size: int, optional</dt><dd><p>Number of <code class="docutils literal notranslate"><span class="pre">retention_config.index_col</span></code> values in each subsample. Cannot be used with frac. Default: <code class="docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
<dt>replace: bool, optional</dt><dd><p>Subsampling with replace. Default: <code class="docutils literal notranslate"><span class="pre">True</span></code></p>
</dd>
<dt>weights: float</dt><dd><p>Weights of each sample for weighted random sampling. Default: <code class="docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
<dt>random_state: int, optional</dt><dd><p>Random state for sampling.</p>
</dd>
</dl>
<p>Value of CSI</p>
<p>Float</p>
</dd></dl>

<dl class="py function">
<dt id="retentioneering.core.clustering.dbscan">
<code class="sig-prename descclassname">retentioneering.core.clustering.</code><code class="sig-name descname">dbscan</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">use_csi</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">epsq</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">max_cl_number</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/retentioneering/core/clustering.html#dbscan"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#retentioneering.core.clustering.dbscan" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds cluster of users in data using DBSCAN</p>
<dl class="simple">
<dt>data: pd.DataFrame</dt><dd><p>Dataframe with features for clustering indexed by users (sessions)</p>
</dd>
<dt>use_csi: bool, optional</dt><dd><p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, then cluster stability index will be calculated. IMPORTANT: it may take a lot of time. Default: <code class="docutils literal notranslate"><span class="pre">True</span></code></p>
</dd>
<dt>epsq: float, optional</dt><dd><p>Quantile of nearest neighbor positive distance between dots, its value will be an eps. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, then eps from keywords will be used. Default: <code class="docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
<dt>max_cl_number: int, optional</dt><dd><p>Maximal number of clusters for aggregation of small clusters. Default: <code class="docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
<dt>kwargs: optional</dt><dd><p>Parameters for <code class="docutils literal notranslate"><span class="pre">sklearn.cluster.KMeans</span></code></p>
</dd>
</dl>
<p>Array of clusters</p>
<p>np.array</p>
</dd></dl>

<dl class="py function">
<dt id="retentioneering.core.clustering.find_best_eps">
<code class="sig-prename descclassname">retentioneering.core.clustering.</code><code class="sig-name descname">find_best_eps</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">q</span><span class="o">=</span><span class="default_value">0.05</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/retentioneering/core/clustering.html#find_best_eps"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#retentioneering.core.clustering.find_best_eps" title="Permalink to this definition">¶</a></dt>
<dd><p>Find best maximal distance (eps) between dots for DBSCAN clustering.</p>
<dl class="simple">
<dt>data: pd.DataFrame</dt><dd><p>Dataframe with features for clustering indexed as in <code class="docutils literal notranslate"><span class="pre">retention_config.index_col</span></code></p>
</dd>
<dt>q: float, optional</dt><dd><p>Quantile of nearest neighbor positive distance between dots. The value of it will be an eps. Default: <code class="docutils literal notranslate"><span class="pre">0.05</span></code></p>
</dd>
</dl>
<p>Optimal eps</p>
<p>Float</p>
</dd></dl>

<dl class="py function">
<dt id="retentioneering.core.clustering.find_best_n_clusters">
<code class="sig-prename descclassname">retentioneering.core.clustering.</code><code class="sig-name descname">find_best_n_clusters</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">clusterer</span></em>, <em class="sig-param"><span class="n">max_n_clusters</span></em>, <em class="sig-param"><span class="n">random_state</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/retentioneering/core/clustering.html#find_best_n_clusters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#retentioneering.core.clustering.find_best_n_clusters" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds best number of clusters for KMeans and Gaussian Mixture.</p>
<dl class="simple">
<dt>data: pd.DataFrame</dt><dd><p>Dataframe with features for clustering with index as in <code class="docutils literal notranslate"><span class="pre">retention_config.index_col</span></code></p>
</dd>
<dt>clusterer: sklearn clusterer class</dt><dd><p>For instance, <code class="docutils literal notranslate"><span class="pre">sklearn.cluster.KMeans</span></code> or <code class="docutils literal notranslate"><span class="pre">sklearn.mixture.GaussianMixture</span></code>.</p>
</dd>
<dt>max_n_clusters: int</dt><dd><p>Maximal number of clusters for searching.</p>
</dd>
<dt>random_state: int</dt><dd><p>Random state for clusterer.</p>
</dd>
</dl>
<p>Optimal keyword arguments for clustering method.</p>
<p>Dict</p>
</dd></dl>

<dl class="py function">
<dt id="retentioneering.core.clustering.simple_cluster">
<code class="sig-prename descclassname">retentioneering.core.clustering.</code><code class="sig-name descname">simple_cluster</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">max_n_clusters</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">use_csi</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">random_state</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/retentioneering/core/clustering.html#simple_cluster"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#retentioneering.core.clustering.simple_cluster" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds cluster of users in data.</p>
<dl class="simple">
<dt>data: pd.DataFrame</dt><dd><p>Dataframe with features for clustering indexed as in <code class="docutils literal notranslate"><span class="pre">retention_config.index_col</span></code></p>
</dd>
<dt>max_n_clusters: int, optional</dt><dd><p>Maximal number of clusters for automatic selection for number of clusters. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, then uses n_clusters from arguments. Default: <cite>None``</cite></p>
</dd>
<dt>use_csi: bool, optional</dt><dd><p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, then cluster stability index will be calculated. IMPORTANT: it may take a lot of time. Default: <code class="docutils literal notranslate"><span class="pre">True</span></code></p>
</dd>
<dt>random_state: int, optional</dt><dd><p>Random state for KMeans clusterer. Default: <code class="docutils literal notranslate"><span class="pre">0</span></code></p>
</dd>
<dt>kwargs: optional</dt><dd><p>Parameters for <code class="docutils literal notranslate"><span class="pre">sklearn.cluster.KMeans</span></code></p>
</dd>
</dl>
<p>Array of clusters</p>
<p>np.array</p>
</dd></dl>

</div>
<div class="section" id="module-retentioneering.core.feature_extraction">
<span id="retentioneering-core-feature-extraction-module"></span><h2>retentioneering.core.feature_extraction module<a class="headerlink" href="#module-retentioneering.core.feature_extraction" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="retentioneering.core.feature_extraction.counts_embedder">
<code class="sig-prename descclassname">retentioneering.core.feature_extraction.</code><code class="sig-name descname">counts_embedder</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">ngram_range</span><span class="o">=</span><span class="default_value">1, 1</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/retentioneering/core/feature_extraction.html#counts_embedder"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#retentioneering.core.feature_extraction.counts_embedder" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate <code class="docutils literal notranslate"><span class="pre">index_col</span></code> embedding (continuous vector form) by counting <code class="docutils literal notranslate"><span class="pre">event_col</span></code> appearance for each <code class="docutils literal notranslate"><span class="pre">index_col</span></code>.</p>
<dl class="simple">
<dt>data: pd.DataFrame</dt><dd><p>Clickstream dataset.</p>
</dd>
<dt>ngram_range: tuple, optional</dt><dd><p>Range of ngrams to use in feature extraction. Default: <code class="docutils literal notranslate"><span class="pre">(1,</span> <span class="pre">1)</span></code></p>
</dd>
<dt>index_col: str, optional</dt><dd><p>Name of custom index column, for more information refer to <code class="docutils literal notranslate"><span class="pre">init_config</span></code>. For instance, if in config you have defined <code class="docutils literal notranslate"><span class="pre">index_col</span></code> as <code class="docutils literal notranslate"><span class="pre">user_id</span></code>, but want to use function over sessions. By default the column defined in <code class="docutils literal notranslate"><span class="pre">init_config</span></code> will be used as <code class="docutils literal notranslate"><span class="pre">index_col</span></code>.</p>
</dd>
<dt>event_col: str, optional</dt><dd><p>Name of custom event column, for more information refer to <code class="docutils literal notranslate"><span class="pre">init_config</span></code>. For instance, you may want to aggregate some events or rename and use it as new event column. By default the column defined in <code class="docutils literal notranslate"><span class="pre">init_config</span></code> will be used as <code class="docutils literal notranslate"><span class="pre">event_col</span></code>.</p>
</dd>
<dt>last_k: int, optional</dt><dd><p>Include only the last <code class="docutils literal notranslate"><span class="pre">last_k</span></code> events for each <code class="docutils literal notranslate"><span class="pre">index_col</span></code>.</p>
</dd>
<dt>wo_last: int, optional</dt><dd><p>Exclude <code class="docutils literal notranslate"><span class="pre">last_k</span></code> events for each <code class="docutils literal notranslate"><span class="pre">index_col</span></code>.</p>
</dd>
</dl>
<p>Vectorized dataframe with <code class="docutils literal notranslate"><span class="pre">index_col</span></code> as index and counts of <code class="docutils literal notranslate"><span class="pre">event_col</span></code> values as dataframe values.</p>
<p>pd.DataFrame</p>
</dd></dl>

<dl class="py function">
<dt id="retentioneering.core.feature_extraction.drop_equal_features">
<code class="sig-prename descclassname">retentioneering.core.feature_extraction.</code><code class="sig-name descname">drop_equal_features</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">features</span></em>, <em class="sig-param"><span class="n">users</span></em>, <em class="sig-param"><span class="n">thres</span><span class="o">=</span><span class="default_value">0.1</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/retentioneering/core/feature_extraction.html#drop_equal_features"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#retentioneering.core.feature_extraction.drop_equal_features" title="Permalink to this definition">¶</a></dt>
<dd><p>Drop nonzero features with equal counts of negative and positive user’s</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>features</strong> – array of features</p></li>
<li><p><strong>users</strong> – list of positive users (e.g. data.rete.get_positive_users())</p></li>
<li><p><strong>thres</strong> – threshold of dropping (e.g 0.1 means area of drop equals [0.9,1.1]</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>dropped features: array of features</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="retentioneering.core.feature_extraction.frequency_embedder">
<code class="sig-prename descclassname">retentioneering.core.feature_extraction.</code><code class="sig-name descname">frequency_embedder</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">ngram_range</span><span class="o">=</span><span class="default_value">1, 1</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/retentioneering/core/feature_extraction.html#frequency_embedder"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#retentioneering.core.feature_extraction.frequency_embedder" title="Permalink to this definition">¶</a></dt>
<dd><p>Similar to <code class="docutils literal notranslate"><span class="pre">count_embedder()</span></code>, but normalizes events count over <code class="docutils literal notranslate"><span class="pre">index_col</span></code>.</p>
<dl class="simple">
<dt>data: pd.DataFrame</dt><dd><p>Clickstream dataset.</p>
</dd>
<dt>ngram_range: tuple, optional</dt><dd><p>Range of ngrams to use in feature extraction. Default: <code class="docutils literal notranslate"><span class="pre">(1,</span> <span class="pre">1)</span></code></p>
</dd>
<dt>index_col: str, optional</dt><dd><p>Name of custom index column, for more information refer to <code class="docutils literal notranslate"><span class="pre">init_config</span></code>. For instance, if in config you have defined <code class="docutils literal notranslate"><span class="pre">index_col</span></code> as <code class="docutils literal notranslate"><span class="pre">user_id</span></code>, but want to use function over sessions. By default the column defined in <code class="docutils literal notranslate"><span class="pre">init_config</span></code> will be used as <code class="docutils literal notranslate"><span class="pre">index_col</span></code>.</p>
</dd>
<dt>event_col: str, optional</dt><dd><p>Name of custom event column, for more information refer to <code class="docutils literal notranslate"><span class="pre">init_config</span></code>. For instance, you may want to aggregate some events or rename and use it as new event column. By default the column defined in <code class="docutils literal notranslate"><span class="pre">init_config</span></code> will be used as <code class="docutils literal notranslate"><span class="pre">event_col</span></code>.</p>
</dd>
</dl>
<p>Dataframe with sessions vectorized by frequencies of events.</p>
<p>pd.DataFrame</p>
</dd></dl>

<dl class="py function">
<dt id="retentioneering.core.feature_extraction.get_manifold">
<code class="sig-prename descclassname">retentioneering.core.feature_extraction.</code><code class="sig-name descname">get_manifold</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">manifold_type</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/retentioneering/core/feature_extraction.html#get_manifold"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#retentioneering.core.feature_extraction.get_manifold" title="Permalink to this definition">¶</a></dt>
<dd><p>Reduces number of dimensions.</p>
<dl class="simple">
<dt>data: pd.DataFrame</dt><dd><p>Dataframe with features for clustering indexed as in <code class="docutils literal notranslate"><span class="pre">retention_config.index_col</span></code></p>
</dd>
<dt>manifold_type: str</dt><dd><p>Name dimensionality reduction method from <code class="docutils literal notranslate"><span class="pre">sklearn.decomposition</span></code> and <code class="docutils literal notranslate"><span class="pre">sklearn.manifold</span></code></p>
</dd>
<dt>kwargs: optional</dt><dd><p>Parameters for <code class="docutils literal notranslate"><span class="pre">sklearn.decomposition</span></code> and <code class="docutils literal notranslate"><span class="pre">sklearn.manifold</span></code> methods.</p>
</dd>
</dl>
<p>pd.DataFrame with reduced dimensions.</p>
<p>pd.DataFrame</p>
</dd></dl>

<dl class="py function">
<dt id="retentioneering.core.feature_extraction.learn_tsne">
<code class="sig-prename descclassname">retentioneering.core.feature_extraction.</code><code class="sig-name descname">learn_tsne</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/retentioneering/core/feature_extraction.html#learn_tsne"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#retentioneering.core.feature_extraction.learn_tsne" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates TSNE transformation for given matrix features.</p>
<dl class="simple">
<dt>data: np.array</dt><dd><p>Array of features.</p>
</dd>
<dt>kwargs: optional</dt><dd><p>Parameters for <code class="docutils literal notranslate"><span class="pre">sklearn.manifold.TSNE()</span></code></p>
</dd>
</dl>
<p>Calculated TSNE transform</p>
<p>np.ndarray</p>
</dd></dl>

<dl class="py function">
<dt id="retentioneering.core.feature_extraction.learn_umap">
<code class="sig-prename descclassname">retentioneering.core.feature_extraction.</code><code class="sig-name descname">learn_umap</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/retentioneering/core/feature_extraction.html#learn_umap"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#retentioneering.core.feature_extraction.learn_umap" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates UMAP transformation for given matrix features.</p>
<dl class="simple">
<dt>data: np.array</dt><dd><p>Array of features.</p>
</dd>
<dt>kwargs: optional</dt><dd><p>Parameters for <code class="docutils literal notranslate"><span class="pre">umap.UMAP()</span></code></p>
</dd>
</dl>
<p>Calculated UMAP transform</p>
<p>np.ndarray</p>
</dd></dl>

<dl class="py function">
<dt id="retentioneering.core.feature_extraction.merge_features">
<code class="sig-prename descclassname">retentioneering.core.feature_extraction.</code><code class="sig-name descname">merge_features</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">features</span></em>, <em class="sig-param"><span class="n">metadata</span></em>, <em class="sig-param"><span class="n">meta_index_col</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">manifold_type</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">fillna</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">drop</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/retentioneering/core/feature_extraction.html#merge_features"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#retentioneering.core.feature_extraction.merge_features" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds metadata to TFIDF of trajectories. Eeduced if <code class="docutils literal notranslate"><span class="pre">manifold_type</span></code> is not <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
<dl class="simple">
<dt>features: pd.DataFrame</dt><dd><p>Dataframe with users` metadata.</p>
</dd>
<dt>metadata: pd.DataFrame</dt><dd><p>Dataframe with user or session properties or any other information you would like to extract as features (e.g. user properties, LTV values, etc.). Default: <code class="docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
<dt>meta_index_col: str, optional</dt><dd><p>Used when metadata is not <code class="docutils literal notranslate"><span class="pre">None</span></code>. Name of column in <code class="docutils literal notranslate"><span class="pre">metadata</span></code> dataframe that contains the same ID as in <code class="docutils literal notranslate"><span class="pre">index_col</span></code>, or if not defined, same as in retention_config (e.g ID of users or sessions). If <code class="docutils literal notranslate"><span class="pre">None</span></code>, then index of metadata dataframe is used instead. Default: <code class="docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
<dt>manifold_type: str, optional</dt><dd><p>Name dimensionality reduction method from <code class="docutils literal notranslate"><span class="pre">sklearn.decomposition</span></code> and <code class="docutils literal notranslate"><span class="pre">sklearn.manifold</span></code>. Default: <code class="docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
<dt>fillna: optional</dt><dd><p>Value for filling missing metadata for any <code class="docutils literal notranslate"><span class="pre">index_col</span></code> value. Default: <code class="docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
<dt>drop: bool, optional</dt><dd><p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, then drops users which do not exist in <code class="docutils literal notranslate"><span class="pre">metadata</span></code> dataframe. Default: <code class="docutils literal notranslate"><span class="pre">False</span></code></p>
</dd>
<dt>kwargs: optional</dt><dd><p>Keyword arguments for <code class="docutils literal notranslate"><span class="pre">sklearn.decomposition</span></code> and <code class="docutils literal notranslate"><span class="pre">sklearn.manifold</span></code> methods.</p>
</dd>
</dl>
<p>Dataframe with trajectory features (possibly reduced) and users metadata.</p>
<p>pd.DataFrame</p>
</dd></dl>

<dl class="py function">
<dt id="retentioneering.core.feature_extraction.tfidf_embedder">
<code class="sig-prename descclassname">retentioneering.core.feature_extraction.</code><code class="sig-name descname">tfidf_embedder</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">ngram_range</span><span class="o">=</span><span class="default_value">1, 1</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/retentioneering/core/feature_extraction.html#tfidf_embedder"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#retentioneering.core.feature_extraction.tfidf_embedder" title="Permalink to this definition">¶</a></dt>
<dd><p>Similar to <code class="docutils literal notranslate"><span class="pre">frequency_embedder()</span></code>, but normalizes event frequencies with inversed document frequency.</p>
<dl class="simple">
<dt>data: pd.DataFrame</dt><dd><p>Clickstream dataset.</p>
</dd>
<dt>ngram_range: tuple, optional</dt><dd><p>Range of ngrams to use in feature extraction. Default: <code class="docutils literal notranslate"><span class="pre">(1,</span> <span class="pre">1)</span></code></p>
</dd>
<dt>index_col: str, optional</dt><dd><p>Name of custom index column, for more information refer to <code class="docutils literal notranslate"><span class="pre">init_config</span></code>. For instance, if in config you have defined <code class="docutils literal notranslate"><span class="pre">index_col</span></code> as <code class="docutils literal notranslate"><span class="pre">user_id</span></code>, but want to use function over sessions. By default the column defined in <code class="docutils literal notranslate"><span class="pre">init_config</span></code> will be used as <code class="docutils literal notranslate"><span class="pre">index_col</span></code>.</p>
</dd>
<dt>event_col: str, optional</dt><dd><p>Name of custom event column, for more information refer to <code class="docutils literal notranslate"><span class="pre">init_config</span></code>. For instance, you may want to aggregate some events or rename and use it as new event column. By default the column defined in <code class="docutils literal notranslate"><span class="pre">init_config</span></code> will be used as <code class="docutils literal notranslate"><span class="pre">event_col</span></code>.</p>
</dd>
</dl>
<p>Dataframe with <code class="docutils literal notranslate"><span class="pre">index_col</span></code> vectorized by TF-IDF of events.</p>
<p>pd.DataFrame</p>
</dd></dl>

</div>
<div class="section" id="module-retentioneering.core.model">
<span id="retentioneering-core-model-module"></span><h2>retentioneering.core.model module<a class="headerlink" href="#module-retentioneering.core.model" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="retentioneering.core.model.ModelDescriptor">
<em class="property">class </em><code class="sig-prename descclassname">retentioneering.core.model.</code><code class="sig-name descname">ModelDescriptor</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span></em>, <em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">target</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/retentioneering/core/model.html#ModelDescriptor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#retentioneering.core.model.ModelDescriptor" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt id="retentioneering.core.model.ModelDescriptor.permutation_importance">
<code class="sig-name descname">permutation_importance</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">test_sample</span></em>, <em class="sig-param"><span class="n">test_target</span></em>, <em class="sig-param"><span class="n">node_params</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/retentioneering/core/model.html#ModelDescriptor.permutation_importance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#retentioneering.core.model.ModelDescriptor.permutation_importance" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates permutation importance of features.
If <code class="docutils literal notranslate"><span class="pre">node_params</span></code> is not <cite>None</cite>, then plots graph weighted by permutation importance.</p>
<dl>
<dt>test_sample: pd.DataFrame</dt><dd><p>Test feature subsample.</p>
</dd>
<dt>test_target: np.array</dt><dd><p>Vector of targets for test sample.</p>
</dd>
<dt>node_params: dict, optional</dt><dd><dl class="simple">
<dt>Event mapping describing which nodes or edges should be highlighted by different colors for better visualisation. Dictionary keys are <code class="docutils literal notranslate"><span class="pre">event_col</span></code> values, while keys have the following possible values:</dt><dd><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">bad_target</span></code>: highlights node and all incoming edges with red color;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nice_target</span></code>: highlights node and all incoming edges with green color;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">bad_node</span></code>: highlights node with red color;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nice_node</span></code>: highlights node with green color;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">source</span></code>: highlights node and all outgoing edges with yellow color.</p></li>
</ul>
</dd>
</dl>
<p>Example <code class="docutils literal notranslate"><span class="pre">node_params</span></code> is shown below:
<a href="#id9"><span class="problematic" id="id10">``</span></a>`
{</p>
<blockquote>
<div><p>‘lost’: ‘bad_target’,
‘purchased’: ‘nice_target’,
‘onboarding_welcome_screen’: ‘source’,
‘choose_login_type’: ‘nice_node’,
‘accept_privacy_policy’: ‘bad_node’,</p>
</div></blockquote>
<p>If <code class="docutils literal notranslate"><span class="pre">node_params=None</span></code>, it will be constructed from <code class="docutils literal notranslate"><span class="pre">retention_config</span></code> variable, so that:
<a href="#id11"><span class="problematic" id="id12">``</span></a>`
{</p>
<blockquote>
<div><p>‘positive_target_event’: ‘nice_target’,
‘negative_target_event’: ‘bad_target’,
‘source_event’: ‘source’,</p>
</div></blockquote>
<p>Default: <code class="docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="retentioneering.core.model.ModelDescriptor.permutation_importance_raw">
<code class="sig-name descname">permutation_importance_raw</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">test</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/retentioneering/core/model.html#ModelDescriptor.permutation_importance_raw"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#retentioneering.core.model.ModelDescriptor.permutation_importance_raw" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="retentioneering.core.model.ModelDescriptor.predict">
<code class="sig-name descname">predict</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">features</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/retentioneering/core/model.html#ModelDescriptor.predict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#retentioneering.core.model.ModelDescriptor.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Predicts probability of <code class="docutils literal notranslate"><span class="pre">positive_target_event</span></code> and <code class="docutils literal notranslate"><span class="pre">negative_target_event</span></code> in classifacation task or values of <code class="docutils literal notranslate"><span class="pre">regeression_targets</span></code> in regression task.</p>
<dl class="simple">
<dt>features: pd.DataFrame</dt><dd><p>Dataframe with test features. For more information refer to <code class="docutils literal notranslate"><span class="pre">prepare_test()</span></code> method.</p>
</dd>
</dl>
<p>Dataframe with predictions.</p>
<p>pd.DataFrame</p>
</dd></dl>

<dl class="py method">
<dt id="retentioneering.core.model.ModelDescriptor.predict_raw">
<code class="sig-name descname">predict_raw</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/retentioneering/core/model.html#ModelDescriptor.predict_raw"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#retentioneering.core.model.ModelDescriptor.predict_raw" title="Permalink to this definition">¶</a></dt>
<dd><p>Predicts probability of <code class="docutils literal notranslate"><span class="pre">positive_target_event</span></code> and <code class="docutils literal notranslate"><span class="pre">negative_target_event</span></code> in classifacation task or values of <code class="docutils literal notranslate"><span class="pre">regeression_targets</span></code> in regression task.</p>
<dl class="simple">
<dt>data: pd.DataFrame</dt><dd><p>Raw clickstream.</p>
</dd>
</dl>
<p>Dataframe with predictions.</p>
<p>pd.DataFrame</p>
</dd></dl>

<dl class="py method">
<dt id="retentioneering.core.model.ModelDescriptor.prepare_test">
<code class="sig-name descname">prepare_test</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">test</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/retentioneering/core/model.html#ModelDescriptor.prepare_test"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#retentioneering.core.model.ModelDescriptor.prepare_test" title="Permalink to this definition">¶</a></dt>
<dd><p>Transforms test clickstream into train.</p>
<dl class="simple">
<dt>test: pd.DataFrame</dt><dd><p>Raw clickstream.</p>
</dd>
</dl>
<p>Dataframe with test features.</p>
<p>pd.DataFrame</p>
</dd></dl>

<dl class="py method">
<dt id="retentioneering.core.model.ModelDescriptor.show_quality_metrics">
<code class="sig-name descname">show_quality_metrics</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">test_sample</span></em>, <em class="sig-param"><span class="n">test_target</span></em>, <em class="sig-param"><span class="n">use_print</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/retentioneering/core/model.html#ModelDescriptor.show_quality_metrics"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#retentioneering.core.model.ModelDescriptor.show_quality_metrics" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate model quality metrics.</p>
<dl class="simple">
<dt>test_sample: pd.DataFrame</dt><dd><p>Test feature subsample.</p>
</dd>
<dt>test_target: np.array</dt><dd><p>Vector of targets for test sample.</p>
</dd>
<dt>use_print: bool, optional</dt><dd><p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, prints out ROC-AUC, PR-AUC and accuracy in prediction task and RMSE, MAE and R-Squared in regression task.</p>
</dd>
</dl>
<p>ROC-AUC, PR-AUC and accuracy metrics in prediction task and RMSE, MAE and R-Squared in regression task.</p>
<p>Int</p>
</dd></dl>

<dl class="py method">
<dt id="retentioneering.core.model.ModelDescriptor.show_quality_raw">
<code class="sig-name descname">show_quality_raw</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">test</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/retentioneering/core/model.html#ModelDescriptor.show_quality_raw"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#retentioneering.core.model.ModelDescriptor.show_quality_raw" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="retentioneering.core.model.ModelDescriptor.visualize_results">
<code class="sig-name descname">visualize_results</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">plot_type</span><span class="o">=</span><span class="default_value">'projections'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/retentioneering/core/model.html#ModelDescriptor.visualize_results"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#retentioneering.core.model.ModelDescriptor.visualize_results" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="retentioneering-core-node-metrics-module">
<h2>retentioneering.core.node_metrics module<a class="headerlink" href="#retentioneering-core-node-metrics-module" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-retentioneering.core.preprocessing">
<span id="retentioneering-core-preprocessing-module"></span><h2>retentioneering.core.preprocessing module<a class="headerlink" href="#module-retentioneering.core.preprocessing" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="retentioneering.core.preprocessing.weight_by_mechanics">
<code class="sig-prename descclassname">retentioneering.core.preprocessing.</code><code class="sig-name descname">weight_by_mechanics</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">main_event_map</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/retentioneering/core/preprocessing.html#weight_by_mechanics"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#retentioneering.core.preprocessing.weight_by_mechanics" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates weights of mechanics over <code class="docutils literal notranslate"><span class="pre">index_col</span></code>.</p>
<dl class="simple">
<dt>data: pd.DataFrame</dt><dd><p>Сlickstream or features data.</p>
</dd>
<dt>main_event_map: dict</dt><dd><p>Mapping of main events into mechanics.</p>
</dd>
<dt>kwargs: optional</dt><dd><p><code class="docutils literal notranslate"><span class="pre">sklearn.decomposition.LatentDirichletAllocation()</span></code> and <code class="docutils literal notranslate"><span class="pre">BaseDataset.rete.extract_features()</span></code> parameters.</p>
</dd>
</dl>
<p>Weights of mechanics for each <code class="docutils literal notranslate"><span class="pre">index_col</span></code> and mechanics description.</p>
</dd></dl>

</div>
<div class="section" id="module-retentioneering.core.tree_selector">
<span id="retentioneering-core-tree-selector-module"></span><h2>retentioneering.core.tree_selector module<a class="headerlink" href="#module-retentioneering.core.tree_selector" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="retentioneering.core.tree_selector.show_tree_filter">
<code class="sig-prename descclassname">retentioneering.core.tree_selector.</code><code class="sig-name descname">show_tree_filter</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">event_col</span></em>, <em class="sig-param"><span class="n">width</span><span class="o">=</span><span class="default_value">500</span></em>, <em class="sig-param"><span class="n">height</span><span class="o">=</span><span class="default_value">500</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/retentioneering/core/tree_selector.html#show_tree_filter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#retentioneering.core.tree_selector.show_tree_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Shows tree selector for events filtering and aggregation, based on values in <code class="docutils literal notranslate"><span class="pre">event_col</span></code> column. It uses <cite>_</cite> for event names splitting, so ideally the event name structure in the dataset should include underscores and have a hierarchical, e.g. <code class="docutils literal notranslate"><span class="pre">[section]_[page]_[action]</span></code>. In this case event names are separated into levels, so that all the events with the same <code class="docutils literal notranslate"><span class="pre">[section]</span></code> will be placed under the same tree node, etc.
There two kind of checkboxes in tree selector: large blue and small white. The former are used to include or exclude event from original dataset. The latter are used for event aggregation: toggle on a checkbox against an event name level, e.g. a specific <code class="docutils literal notranslate"><span class="pre">[section]_[page]</span></code>, to aggregate all the underlying events, all the <code class="docutils literal notranslate"><span class="pre">[actions]</span></code> in this example, to this level.
Tree filter has a download button in the end of event list, which downloads a JSON config file, which you then need to use to filter and aggregate events with <code class="docutils literal notranslate"><span class="pre">use_tree_filter()</span></code> function.</p>
<dl class="simple">
<dt>event_col: str</dt><dd><p>Column with event names.</p>
</dd>
<dt>width: int, optional</dt><dd><p>Width of IFrame in pixels.</p>
</dd>
<dt>height: int, optional</dt><dd><p>Height of IFrame in pixels.</p>
</dd>
</dl>
<p>Renders events tree selector</p>
<p>IFrame</p>
</dd></dl>

<dl class="py function">
<dt id="retentioneering.core.tree_selector.use_tree_filter">
<code class="sig-prename descclassname">retentioneering.core.tree_selector.</code><code class="sig-name descname">use_tree_filter</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">path</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/retentioneering/core/tree_selector.html#use_tree_filter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#retentioneering.core.tree_selector.use_tree_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Uses generated with <code class="docutils literal notranslate"><span class="pre">show_tree_filter()</span></code> JSON config to filter and aggregate <code class="docutils literal notranslate"><span class="pre">event_col</span></code> values of dataset.</p>
<dl class="simple">
<dt>data: pd.DataFrame</dt><dd><p>Event dataset. Should include the same event column as in <code class="docutils literal notranslate"><span class="pre">event_col</span></code> of <code class="docutils literal notranslate"><span class="pre">retention_config</span></code>.</p>
</dd>
<dt>path: str</dt><dd><p>Path to JSON config file generated with <code class="docutils literal notranslate"><span class="pre">show_tree_filter()</span></code> function.</p>
</dd>
</dl>
<p>Filtered and aggregated dataset</p>
<p>pd.DataFrame</p>
</dd></dl>

</div>
<div class="section" id="retentioneering-core-utils-module">
<h2>retentioneering.core.utils module<a class="headerlink" href="#retentioneering-core-utils-module" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-retentioneering.core">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-retentioneering.core" title="Permalink to this headline">¶</a></h2>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="retentioneering.visualization.html" class="btn btn-neutral float-right" title="retentioneering.visualization package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="retentioneering.html" class="btn btn-neutral float-left" title="retentioneering package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, &#34;Data Driven Lab&#34; LLC

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
    <br><br>More information about our services at <a href="https://retentioneering.com/">Retentioneering.com</a>.


</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>