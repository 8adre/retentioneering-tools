

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>retentioneering.core package &mdash; Retentioneering Tools 1.0.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="retentioneering.visualization package" href="retentioneering.visualization.html" />
    <link rel="prev" title="retentioneering package" href="retentioneering.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Retentioneering Tools
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="early_steps.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="mobile-app-case.html">Mobile app case</a></li>
<li class="toctree-l1"><a class="reference internal" href="release-notes.html">Release 1.0.4 description</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="retentioneering.html">Documentation</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="retentioneering.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">retentioneering.core package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-retentioneering.core.attribution">retentioneering.core.attribution module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-retentioneering.core.clustering">retentioneering.core.clustering module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-retentioneering.core.feature_extraction">retentioneering.core.feature_extraction module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-retentioneering.core.market_simulator">retentioneering.core.market_simulator module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-retentioneering.core.model">retentioneering.core.model module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-retentioneering.core.node_metrics">retentioneering.core.node_metrics module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-retentioneering.core.preprocessing">retentioneering.core.preprocessing module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-retentioneering.core.simulator">retentioneering.core.simulator module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-retentioneering.core.tree_selector">retentioneering.core.tree_selector module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-retentioneering.core.utils">retentioneering.core.utils module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-retentioneering.core">Module contents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="retentioneering.visualization.html">retentioneering.visualization package</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="retentioneering.html#module-retentioneering">Module contents</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Retentioneering Tools</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="retentioneering.html">retentioneering package</a> &raquo;</li>
        
      <li>retentioneering.core package</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/retentioneering.core.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="retentioneering-core-package">
<h1>retentioneering.core package<a class="headerlink" href="#retentioneering-core-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-retentioneering.core.attribution">
<span id="retentioneering-core-attribution-module"></span><h2>retentioneering.core.attribution module<a class="headerlink" href="#module-retentioneering.core.attribution" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="retentioneering.core.attribution.MultiChannelAttribution">
<em class="property">class </em><code class="descclassname">retentioneering.core.attribution.</code><code class="descname">MultiChannelAttribution</code><span class="sig-paren">(</span><em>obj</em><span class="sig-paren">)</span><a class="headerlink" href="#retentioneering.core.attribution.MultiChannelAttribution" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="method">
<dt id="retentioneering.core.attribution.MultiChannelAttribution.attributive_sampling">
<code class="descname">attributive_sampling</code><span class="sig-paren">(</span><em>atmetric</em>, <em>tmp=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#retentioneering.core.attribution.MultiChannelAttribution.attributive_sampling" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="retentioneering.core.attribution.MultiChannelAttribution.calc_distribution">
<code class="descname">calc_distribution</code><span class="sig-paren">(</span><em>at</em><span class="sig-paren">)</span><a class="headerlink" href="#retentioneering.core.attribution.MultiChannelAttribution.calc_distribution" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="retentioneering.core.attribution.MultiChannelAttribution.causal_effect">
<code class="descname">causal_effect</code><span class="sig-paren">(</span><em>target_col=None</em>, <em>target_event=None</em>, <em>event_col=None</em>, <em>index_col=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#retentioneering.core.attribution.MultiChannelAttribution.causal_effect" title="Permalink to this definition">¶</a></dt>
<dd><p>Causal effect for channel is a difference between overall conversion rate
and conversion rate without the channel</p>
</dd></dl>

<dl class="method">
<dt id="retentioneering.core.attribution.MultiChannelAttribution.check_openning">
<code class="descname">check_openning</code><span class="sig-paren">(</span><em>target_col=None</em>, <em>target_event=None</em>, <em>event_col=None</em>, <em>index_col=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#retentioneering.core.attribution.MultiChannelAttribution.check_openning" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="retentioneering.core.attribution.MultiChannelAttribution.find_attr_weights">
<code class="descname">find_attr_weights</code><span class="sig-paren">(</span><em>mod</em>, <em>event_col=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#retentioneering.core.attribution.MultiChannelAttribution.find_attr_weights" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="retentioneering.core.attribution.MultiChannelAttribution.first_touch">
<code class="descname">first_touch</code><span class="sig-paren">(</span><em>target_col=None</em>, <em>target_event=None</em>, <em>event_col=None</em>, <em>index_col=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#retentioneering.core.attribution.MultiChannelAttribution.first_touch" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="retentioneering.core.attribution.MultiChannelAttribution.last_touch">
<code class="descname">last_touch</code><span class="sig-paren">(</span><em>target_col=None</em>, <em>target_event=None</em>, <em>event_col=None</em>, <em>index_col=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#retentioneering.core.attribution.MultiChannelAttribution.last_touch" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="retentioneering.core.attribution.MultiChannelAttribution.linear">
<code class="descname">linear</code><span class="sig-paren">(</span><em>target_col=None</em>, <em>target_event=None</em>, <em>event_col=None</em>, <em>index_col=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#retentioneering.core.attribution.MultiChannelAttribution.linear" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="retentioneering.core.attribution.MultiChannelAttribution.position_based">
<code class="descname">position_based</code><span class="sig-paren">(</span><em>weight=0.8</em>, <em>target_col=None</em>, <em>target_event=None</em>, <em>event_col=None</em>, <em>index_col=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#retentioneering.core.attribution.MultiChannelAttribution.position_based" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="retentioneering.core.attribution.MultiChannelAttribution.removal_effect">
<code class="descname">removal_effect</code><span class="sig-paren">(</span><em>target_col=None</em>, <em>target_event=None</em>, <em>event_col=None</em>, <em>index_col=None</em>, <em>tmp=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#retentioneering.core.attribution.MultiChannelAttribution.removal_effect" title="Permalink to this definition">¶</a></dt>
<dd><p>Removal effect is a rate of missing conversions from all conversions</p>
</dd></dl>

<dl class="method">
<dt id="retentioneering.core.attribution.MultiChannelAttribution.rete_attr">
<code class="descname">rete_attr</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#retentioneering.core.attribution.MultiChannelAttribution.rete_attr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="retentioneering.core.attribution.MultiChannelAttribution.sample_users">
<code class="descname">sample_users</code><span class="sig-paren">(</span><em>ch</em>, <em>dist</em>, <em>event_col=None</em>, <em>index_col=None</em><span class="sig-paren">)</span><a class="headerlink" href="#retentioneering.core.attribution.MultiChannelAttribution.sample_users" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="retentioneering.core.attribution.MultiChannelAttribution.score_all">
<code class="descname">score_all</code><span class="sig-paren">(</span><em>index_col=None</em>, <em>event_col=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#retentioneering.core.attribution.MultiChannelAttribution.score_all" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="retentioneering.core.attribution.MultiChannelAttribution.shapley_value">
<code class="descname">shapley_value</code><span class="sig-paren">(</span><em>target_col=None</em>, <em>target_event=None</em>, <em>event_col=None</em>, <em>index_col=None</em>, <em>chain_length=3</em>, <em>thresh=10</em>, <em>relative_weighting=False</em>, <em>channel_filter=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#retentioneering.core.attribution.MultiChannelAttribution.shapley_value" title="Permalink to this definition">¶</a></dt>
<dd><p>Shapley values is a weighted sum of additional value of each channel into each channel sets</p>
</dd></dl>

<dl class="method">
<dt id="retentioneering.core.attribution.MultiChannelAttribution.time_decay">
<code class="descname">time_decay</code><span class="sig-paren">(</span><em>target_col=None</em>, <em>target_event=None</em>, <em>event_col=None</em>, <em>index_col=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#retentioneering.core.attribution.MultiChannelAttribution.time_decay" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-retentioneering.core.clustering">
<span id="retentioneering-core-clustering-module"></span><h2>retentioneering.core.clustering module<a class="headerlink" href="#module-retentioneering.core.clustering" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="retentioneering.core.clustering.GMM">
<code class="descclassname">retentioneering.core.clustering.</code><code class="descname">GMM</code><span class="sig-paren">(</span><em>data</em>, <em>max_n_clusters=None</em>, <em>use_csi=True</em>, <em>random_state=0</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#retentioneering.core.clustering.GMM" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds cluster of users in data using Gaussian Mixture Models.</p>
<dl class="docutils">
<dt>data: pd.DataFrame</dt>
<dd>Dataframe with features for clustering indexed as in <code class="docutils literal notranslate"><span class="pre">retention_config.index_col</span></code></dd>
<dt>max_n_clusters: int, optional</dt>
<dd>Maximal number of clusters for automatic selection for number of clusters. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, then uses <code class="docutils literal notranslate"><span class="pre">`n_clusters</span></code> from arguments. Default: <cite>None``</cite></dd>
<dt>use_csi: bool, optional</dt>
<dd>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, then cluster stability index will be calculated. IMPORTANT: it may take a lot of time. Default: <code class="docutils literal notranslate"><span class="pre">True</span></code></dd>
<dt>random_state: int, optional</dt>
<dd>Random state for GaussianMixture clusterer.</dd>
<dt>kwargs: optional</dt>
<dd>Parameters for <code class="docutils literal notranslate"><span class="pre">sklearn.mixture.GaussianMixture</span></code></dd>
</dl>
<p>Array of clusters</p>
<p>np.array</p>
</dd></dl>

<dl class="function">
<dt id="retentioneering.core.clustering.aggregate_cl">
<code class="descclassname">retentioneering.core.clustering.</code><code class="descname">aggregate_cl</code><span class="sig-paren">(</span><em>cl</em>, <em>max_cl_number</em><span class="sig-paren">)</span><a class="headerlink" href="#retentioneering.core.clustering.aggregate_cl" title="Permalink to this definition">¶</a></dt>
<dd><p>Aggregate small clusters to one, based on <code class="docutils literal notranslate"><span class="pre">max_cl_number</span></code>.
Usually it is used for visualization purposes because large number of different colors is hard to distinct.</p>
<dl class="docutils">
<dt>cl: ndarray</dt>
<dd>Results of clustering.</dd>
<dt>max_cl_number: int</dt>
<dd>Maximum number of unique clusters.</dd>
</dl>
<p>Clustering with merged to -1 small clusters.</p>
<p>ndarray</p>
</dd></dl>

<dl class="function">
<dt id="retentioneering.core.clustering.calc_all_metrics">
<code class="descclassname">retentioneering.core.clustering.</code><code class="descname">calc_all_metrics</code><span class="sig-paren">(</span><em>data</em>, <em>km</em><span class="sig-paren">)</span><a class="headerlink" href="#retentioneering.core.clustering.calc_all_metrics" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates all quality metrics: Cluster Stability Index, Silhouette score, Homogeneity, distances for clustering.</p>
<dl class="docutils">
<dt>data: pd.DataFrame</dt>
<dd>Dataframe with features for clustering indexed as in <code class="docutils literal notranslate"><span class="pre">retention_config.index_col</span></code></dd>
<dt>km:</dt>
<dd>Already fitted clusterer.</dd>
</dl>
<p>Metrics scores</p>
<p>Dict</p>
</dd></dl>

<dl class="function">
<dt id="retentioneering.core.clustering.calc_mean_dist_from_center">
<code class="descclassname">retentioneering.core.clustering.</code><code class="descname">calc_mean_dist_from_center</code><span class="sig-paren">(</span><em>data</em>, <em>km</em><span class="sig-paren">)</span><a class="headerlink" href="#retentioneering.core.clustering.calc_mean_dist_from_center" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates mean distance from cluster centers. Note that it will be calculated only for KMeans and GMM, because DBSCAN may have ambiguous form of clusters.</p>
<dl class="docutils">
<dt>data: pd.DataFrame</dt>
<dd>Dataframe with features for clustering indexed as in <code class="docutils literal notranslate"><span class="pre">retention_config.index_col</span></code></dd>
<dt>km:</dt>
<dd>Already fitted clusterer.</dd>
</dl>
<p>Mapping of clusters names to mean distance from cluster centers.</p>
<p>Dict</p>
</dd></dl>

<dl class="function">
<dt id="retentioneering.core.clustering.calc_mean_pd">
<code class="descclassname">retentioneering.core.clustering.</code><code class="descname">calc_mean_pd</code><span class="sig-paren">(</span><em>data</em>, <em>cl</em><span class="sig-paren">)</span><a class="headerlink" href="#retentioneering.core.clustering.calc_mean_pd" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates mean pairwise distance inside clusters.</p>
<dl class="docutils">
<dt>data: pd.DataFrame</dt>
<dd>Dataframe with features for clustering indexed as in <code class="docutils literal notranslate"><span class="pre">retention_config.index_col</span></code></dd>
<dt>cl:</dt>
<dd>Results of clustering.</dd>
</dl>
<p>Mapping of clusters names to pairwise distance inside clusters.</p>
<p>Dict</p>
</dd></dl>

<dl class="function">
<dt id="retentioneering.core.clustering.cluster_stability_index">
<code class="descclassname">retentioneering.core.clustering.</code><code class="descname">cluster_stability_index</code><span class="sig-paren">(</span><em>data</em>, <em>clusterer</em>, <em>base_clusterer=None</em>, <em>n_samples=10</em>, <em>frac=1</em>, <em>sample_size=None</em>, <em>replace=True</em>, <em>weights=None</em>, <em>random_state=0</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#retentioneering.core.clustering.cluster_stability_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates cluster stability index: rate of random data subsamples with unchanged clustering.</p>
<dl class="docutils">
<dt>data: pd.DataFrame</dt>
<dd>Dataframe with features for clustering indexed as in <code class="docutils literal notranslate"><span class="pre">retention_config.index_col</span></code></dd>
<dt>clusterer: sklearn clusterer class</dt>
<dd>For instance, <code class="docutils literal notranslate"><span class="pre">sklearn.cluster.KMeans</span></code> or <code class="docutils literal notranslate"><span class="pre">sklearn.mixture.GaussianMixture</span></code></dd>
<dt>base_clusterer: optional</dt>
<dd>Results of base clustering. Default: <code class="docutils literal notranslate"><span class="pre">None</span></code></dd>
<dt>n_samples: int, optional</dt>
<dd>Number of random subsamples for CSI calculation. Default: <code class="docutils literal notranslate"><span class="pre">10</span></code></dd>
<dt>frac: int, optional</dt>
<dd>Rate of <code class="docutils literal notranslate"><span class="pre">retention_config.index_col</span></code> values in each subsample relative to input data. Default: <code class="docutils literal notranslate"><span class="pre">1</span></code></dd>
<dt>sample_size: int, optional</dt>
<dd>Number of <code class="docutils literal notranslate"><span class="pre">retention_config.index_col</span></code> values in each subsample. Cannot be used with frac. Default: <code class="docutils literal notranslate"><span class="pre">None</span></code></dd>
<dt>replace: bool, optional</dt>
<dd>Subsampling with replace. Default: <code class="docutils literal notranslate"><span class="pre">True</span></code></dd>
<dt>weights: float</dt>
<dd>Weights of each sample for weighted random sampling. Default: <code class="docutils literal notranslate"><span class="pre">None</span></code></dd>
<dt>random_state: int, optional</dt>
<dd>Random state for sampling.</dd>
</dl>
<p>Value of CSI</p>
<p>Float</p>
</dd></dl>

<dl class="function">
<dt id="retentioneering.core.clustering.dbscan">
<code class="descclassname">retentioneering.core.clustering.</code><code class="descname">dbscan</code><span class="sig-paren">(</span><em>data</em>, <em>use_csi=True</em>, <em>epsq=None</em>, <em>max_cl_number=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#retentioneering.core.clustering.dbscan" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds cluster of users in data using DBSCAN</p>
<dl class="docutils">
<dt>data: pd.DataFrame</dt>
<dd>Dataframe with features for clustering indexed by users (sessions)</dd>
<dt>use_csi: bool, optional</dt>
<dd>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, then cluster stability index will be calculated. IMPORTANT: it may take a lot of time. Default: <code class="docutils literal notranslate"><span class="pre">True</span></code></dd>
<dt>epsq: float, optional</dt>
<dd>Quantile of nearest neighbor positive distance between dots, its value will be an eps. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, then eps from keywords will be used. Default: <code class="docutils literal notranslate"><span class="pre">None</span></code></dd>
<dt>max_cl_number: int, optional</dt>
<dd>Maximal number of clusters for aggregation of small clusters. Default: <code class="docutils literal notranslate"><span class="pre">None</span></code></dd>
<dt>kwargs: optional</dt>
<dd>Parameters for <code class="docutils literal notranslate"><span class="pre">sklearn.cluster.KMeans</span></code></dd>
</dl>
<p>Array of clusters</p>
<p>np.array</p>
</dd></dl>

<dl class="function">
<dt id="retentioneering.core.clustering.find_best_eps">
<code class="descclassname">retentioneering.core.clustering.</code><code class="descname">find_best_eps</code><span class="sig-paren">(</span><em>data</em>, <em>q=0.05</em><span class="sig-paren">)</span><a class="headerlink" href="#retentioneering.core.clustering.find_best_eps" title="Permalink to this definition">¶</a></dt>
<dd><p>Find best maximal distance (eps) between dots for DBSCAN clustering.</p>
<dl class="docutils">
<dt>data: pd.DataFrame</dt>
<dd>Dataframe with features for clustering indexed as in <code class="docutils literal notranslate"><span class="pre">retention_config.index_col</span></code></dd>
<dt>q: float, optional</dt>
<dd>Quantile of nearest neighbor positive distance between dots. The value of it will be an eps. Default: <code class="docutils literal notranslate"><span class="pre">0.05</span></code></dd>
</dl>
<p>Optimal eps</p>
<p>Float</p>
</dd></dl>

<dl class="function">
<dt id="retentioneering.core.clustering.find_best_n_clusters">
<code class="descclassname">retentioneering.core.clustering.</code><code class="descname">find_best_n_clusters</code><span class="sig-paren">(</span><em>data</em>, <em>clusterer</em>, <em>max_n_clusters</em>, <em>random_state</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#retentioneering.core.clustering.find_best_n_clusters" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds best number of clusters for KMeans and Gaussian Mixture.</p>
<dl class="docutils">
<dt>data: pd.DataFrame</dt>
<dd>Dataframe with features for clustering with index as in <code class="docutils literal notranslate"><span class="pre">retention_config.index_col</span></code></dd>
<dt>clusterer: sklearn clusterer class</dt>
<dd>For instance, <code class="docutils literal notranslate"><span class="pre">sklearn.cluster.KMeans</span></code> or <code class="docutils literal notranslate"><span class="pre">sklearn.mixture.GaussianMixture</span></code>.</dd>
<dt>max_n_clusters: int</dt>
<dd>Maximal number of clusters for searching.</dd>
<dt>random_state: int</dt>
<dd>Random state for clusterer.</dd>
</dl>
<p>Optimal keyword arguments for clustering method.</p>
<p>Dict</p>
</dd></dl>

<dl class="function">
<dt id="retentioneering.core.clustering.simple_cluster">
<code class="descclassname">retentioneering.core.clustering.</code><code class="descname">simple_cluster</code><span class="sig-paren">(</span><em>data</em>, <em>max_n_clusters=None</em>, <em>use_csi=True</em>, <em>random_state=0</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#retentioneering.core.clustering.simple_cluster" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds cluster of users in data.</p>
<dl class="docutils">
<dt>data: pd.DataFrame</dt>
<dd>Dataframe with features for clustering indexed as in <code class="docutils literal notranslate"><span class="pre">retention_config.index_col</span></code></dd>
<dt>max_n_clusters: int, optional</dt>
<dd>Maximal number of clusters for automatic selection for number of clusters. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, then uses n_clusters from arguments. Default: <cite>None``</cite></dd>
<dt>use_csi: bool, optional</dt>
<dd>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, then cluster stability index will be calculated. IMPORTANT: it may take a lot of time. Default: <code class="docutils literal notranslate"><span class="pre">True</span></code></dd>
<dt>random_state: int, optional</dt>
<dd>Random state for KMeans clusterer. Default: <code class="docutils literal notranslate"><span class="pre">0</span></code></dd>
<dt>kwargs: optional</dt>
<dd>Parameters for <code class="docutils literal notranslate"><span class="pre">sklearn.cluster.KMeans</span></code></dd>
</dl>
<p>Array of clusters</p>
<p>np.array</p>
</dd></dl>

</div>
<div class="section" id="module-retentioneering.core.feature_extraction">
<span id="retentioneering-core-feature-extraction-module"></span><h2>retentioneering.core.feature_extraction module<a class="headerlink" href="#module-retentioneering.core.feature_extraction" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="retentioneering.core.feature_extraction.counts_embedder">
<code class="descclassname">retentioneering.core.feature_extraction.</code><code class="descname">counts_embedder</code><span class="sig-paren">(</span><em>data</em>, <em>ngram_range=(1</em>, <em>1)</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#retentioneering.core.feature_extraction.counts_embedder" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate <code class="docutils literal notranslate"><span class="pre">index_col</span></code> embedding (continuous vector form) by counting <code class="docutils literal notranslate"><span class="pre">event_col</span></code> appearance for each <code class="docutils literal notranslate"><span class="pre">index_col</span></code>.</p>
<dl class="docutils">
<dt>data: pd.DataFrame</dt>
<dd>Clickstream dataset.</dd>
<dt>ngram_range: tuple, optional</dt>
<dd>Range of ngrams to use in feature extraction. Default: <code class="docutils literal notranslate"><span class="pre">(1,</span> <span class="pre">1)</span></code></dd>
<dt>index_col: str, optional</dt>
<dd>Name of custom index column, for more information refer to <code class="docutils literal notranslate"><span class="pre">init_config</span></code>. For instance, if in config you have defined <code class="docutils literal notranslate"><span class="pre">index_col</span></code> as <code class="docutils literal notranslate"><span class="pre">user_id</span></code>, but want to use function over sessions. By default the column defined in <code class="docutils literal notranslate"><span class="pre">init_config</span></code> will be used as <code class="docutils literal notranslate"><span class="pre">index_col</span></code>.</dd>
<dt>event_col: str, optional</dt>
<dd>Name of custom event column, for more information refer to <code class="docutils literal notranslate"><span class="pre">init_config</span></code>. For instance, you may want to aggregate some events or rename and use it as new event column. By default the column defined in <code class="docutils literal notranslate"><span class="pre">init_config</span></code> will be used as <code class="docutils literal notranslate"><span class="pre">event_col</span></code>.</dd>
<dt>last_k: int, optional</dt>
<dd>Include only the last <code class="docutils literal notranslate"><span class="pre">last_k</span></code> events for each <code class="docutils literal notranslate"><span class="pre">index_col</span></code>.</dd>
<dt>wo_last: int, optional</dt>
<dd>Exclude <code class="docutils literal notranslate"><span class="pre">last_k</span></code> events for each <code class="docutils literal notranslate"><span class="pre">index_col</span></code>.</dd>
</dl>
<p>Vectorized dataframe with <code class="docutils literal notranslate"><span class="pre">index_col</span></code> as index and counts of <code class="docutils literal notranslate"><span class="pre">event_col</span></code> values as dataframe values.</p>
<p>pd.DataFrame</p>
</dd></dl>

<dl class="function">
<dt id="retentioneering.core.feature_extraction.drop_equal_features">
<code class="descclassname">retentioneering.core.feature_extraction.</code><code class="descname">drop_equal_features</code><span class="sig-paren">(</span><em>features</em>, <em>users</em>, <em>thres=0.1</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#retentioneering.core.feature_extraction.drop_equal_features" title="Permalink to this definition">¶</a></dt>
<dd><p>Drop nonzero features with equal counts of negative and positive user’s</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>features</strong> – array of features</li>
<li><strong>users</strong> – list of positive users (e.g. data.retention.get_positive_users())</li>
<li><strong>thres</strong> – threshold of dropping (e.g 0.1 means area of drop equals [0.9,1.1]</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">dropped features: array of features</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="retentioneering.core.feature_extraction.frequency_embedder">
<code class="descclassname">retentioneering.core.feature_extraction.</code><code class="descname">frequency_embedder</code><span class="sig-paren">(</span><em>data</em>, <em>ngram_range=(1</em>, <em>1)</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#retentioneering.core.feature_extraction.frequency_embedder" title="Permalink to this definition">¶</a></dt>
<dd><p>Similar to <code class="docutils literal notranslate"><span class="pre">count_embedder()</span></code>, but normalizes events count over <code class="docutils literal notranslate"><span class="pre">index_col</span></code>.</p>
<dl class="docutils">
<dt>data: pd.DataFrame</dt>
<dd>Clickstream dataset.</dd>
<dt>ngram_range: tuple, optional</dt>
<dd>Range of ngrams to use in feature extraction. Default: <code class="docutils literal notranslate"><span class="pre">(1,</span> <span class="pre">1)</span></code></dd>
<dt>index_col: str, optional</dt>
<dd>Name of custom index column, for more information refer to <code class="docutils literal notranslate"><span class="pre">init_config</span></code>. For instance, if in config you have defined <code class="docutils literal notranslate"><span class="pre">index_col</span></code> as <code class="docutils literal notranslate"><span class="pre">user_id</span></code>, but want to use function over sessions. By default the column defined in <code class="docutils literal notranslate"><span class="pre">init_config</span></code> will be used as <code class="docutils literal notranslate"><span class="pre">index_col</span></code>.</dd>
<dt>event_col: str, optional</dt>
<dd>Name of custom event column, for more information refer to <code class="docutils literal notranslate"><span class="pre">init_config</span></code>. For instance, you may want to aggregate some events or rename and use it as new event column. By default the column defined in <code class="docutils literal notranslate"><span class="pre">init_config</span></code> will be used as <code class="docutils literal notranslate"><span class="pre">event_col</span></code>.</dd>
</dl>
<p>Dataframe with sessions vectorized by frequencies of events.</p>
<p>pd.DataFrame</p>
</dd></dl>

<dl class="function">
<dt id="retentioneering.core.feature_extraction.get_manifold">
<code class="descclassname">retentioneering.core.feature_extraction.</code><code class="descname">get_manifold</code><span class="sig-paren">(</span><em>data</em>, <em>manifold_type</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#retentioneering.core.feature_extraction.get_manifold" title="Permalink to this definition">¶</a></dt>
<dd><p>Reduces number of dimensions.</p>
<dl class="docutils">
<dt>data: pd.DataFrame</dt>
<dd>Dataframe with features for clustering indexed as in <code class="docutils literal notranslate"><span class="pre">retention_config.index_col</span></code></dd>
<dt>manifold_type: str</dt>
<dd>Name dimensionality reduction method from <code class="docutils literal notranslate"><span class="pre">sklearn.decomposition</span></code> and <code class="docutils literal notranslate"><span class="pre">sklearn.manifold</span></code></dd>
<dt>kwargs: optional</dt>
<dd>Parameters for <code class="docutils literal notranslate"><span class="pre">sklearn.decomposition</span></code> and <code class="docutils literal notranslate"><span class="pre">sklearn.manifold</span></code> methods.</dd>
</dl>
<p>pd.DataFrame with reduced dimensions.</p>
<p>pd.DataFrame</p>
</dd></dl>

<dl class="function">
<dt id="retentioneering.core.feature_extraction.learn_tsne">
<code class="descclassname">retentioneering.core.feature_extraction.</code><code class="descname">learn_tsne</code><span class="sig-paren">(</span><em>data</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#retentioneering.core.feature_extraction.learn_tsne" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates TSNE transformation for given matrix features.</p>
<dl class="docutils">
<dt>data: np.array</dt>
<dd>Array of features.</dd>
<dt>kwargs: optional</dt>
<dd>Parameters for <code class="docutils literal notranslate"><span class="pre">sklearn.manifold.TSNE()</span></code></dd>
</dl>
<p>Calculated TSNE transform</p>
<p>np.ndarray</p>
</dd></dl>

<dl class="function">
<dt id="retentioneering.core.feature_extraction.merge_features">
<code class="descclassname">retentioneering.core.feature_extraction.</code><code class="descname">merge_features</code><span class="sig-paren">(</span><em>features</em>, <em>metadata</em>, <em>meta_index_col=None</em>, <em>manifold_type=None</em>, <em>fillna=None</em>, <em>drop=False</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#retentioneering.core.feature_extraction.merge_features" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds metadata to TFIDF of trajectories. Eeduced if <code class="docutils literal notranslate"><span class="pre">manifold_type</span></code> is not <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
<dl class="docutils">
<dt>features: pd.DataFrame</dt>
<dd>Dataframe with users` metadata.</dd>
<dt>metadata: pd.DataFrame</dt>
<dd>Dataframe with user or session properties or any other information you would like to extract as features (e.g. user properties, LTV values, etc.). Default: <code class="docutils literal notranslate"><span class="pre">None</span></code></dd>
<dt>meta_index_col: str, optional</dt>
<dd>Used when metadata is not <code class="docutils literal notranslate"><span class="pre">None</span></code>. Name of column in <code class="docutils literal notranslate"><span class="pre">metadata</span></code> dataframe that contains the same ID as in <code class="docutils literal notranslate"><span class="pre">index_col</span></code>, or if not defined, same as in retention_config (e.g ID of users or sessions). If <code class="docutils literal notranslate"><span class="pre">None</span></code>, then index of metadata dataframe is used instead. Default: <code class="docutils literal notranslate"><span class="pre">None</span></code></dd>
<dt>manifold_type: str, optional</dt>
<dd>Name dimensionality reduction method from <code class="docutils literal notranslate"><span class="pre">sklearn.decomposition</span></code> and <code class="docutils literal notranslate"><span class="pre">sklearn.manifold</span></code>. Default: <code class="docutils literal notranslate"><span class="pre">None</span></code></dd>
<dt>fillna: optional</dt>
<dd>Value for filling missing metadata for any <code class="docutils literal notranslate"><span class="pre">index_col</span></code> value. Default: <code class="docutils literal notranslate"><span class="pre">None</span></code></dd>
<dt>drop: bool, optional</dt>
<dd>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, then drops users which do not exist in <code class="docutils literal notranslate"><span class="pre">metadata</span></code> dataframe. Default: <code class="docutils literal notranslate"><span class="pre">False</span></code></dd>
<dt>kwargs: optional</dt>
<dd>Keyword arguments for <code class="docutils literal notranslate"><span class="pre">sklearn.decomposition</span></code> and <code class="docutils literal notranslate"><span class="pre">sklearn.manifold</span></code> methods.</dd>
</dl>
<p>Dataframe with trajectory features (possibly reduced) and users metadata.</p>
<p>pd.DataFrame</p>
</dd></dl>

<dl class="function">
<dt id="retentioneering.core.feature_extraction.tfidf_embedder">
<code class="descclassname">retentioneering.core.feature_extraction.</code><code class="descname">tfidf_embedder</code><span class="sig-paren">(</span><em>data</em>, <em>ngram_range=(1</em>, <em>1)</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#retentioneering.core.feature_extraction.tfidf_embedder" title="Permalink to this definition">¶</a></dt>
<dd><p>Similar to <code class="docutils literal notranslate"><span class="pre">frequency_embedder()</span></code>, but normalizes event frequencies with inversed document frequency.</p>
<dl class="docutils">
<dt>data: pd.DataFrame</dt>
<dd>Clickstream dataset.</dd>
<dt>ngram_range: tuple, optional</dt>
<dd>Range of ngrams to use in feature extraction. Default: <code class="docutils literal notranslate"><span class="pre">(1,</span> <span class="pre">1)</span></code></dd>
<dt>index_col: str, optional</dt>
<dd>Name of custom index column, for more information refer to <code class="docutils literal notranslate"><span class="pre">init_config</span></code>. For instance, if in config you have defined <code class="docutils literal notranslate"><span class="pre">index_col</span></code> as <code class="docutils literal notranslate"><span class="pre">user_id</span></code>, but want to use function over sessions. By default the column defined in <code class="docutils literal notranslate"><span class="pre">init_config</span></code> will be used as <code class="docutils literal notranslate"><span class="pre">index_col</span></code>.</dd>
<dt>event_col: str, optional</dt>
<dd>Name of custom event column, for more information refer to <code class="docutils literal notranslate"><span class="pre">init_config</span></code>. For instance, you may want to aggregate some events or rename and use it as new event column. By default the column defined in <code class="docutils literal notranslate"><span class="pre">init_config</span></code> will be used as <code class="docutils literal notranslate"><span class="pre">event_col</span></code>.</dd>
</dl>
<p>Dataframe with <code class="docutils literal notranslate"><span class="pre">index_col</span></code> vectorized by TF-IDF of events.</p>
<p>pd.DataFrame</p>
</dd></dl>

</div>
<div class="section" id="module-retentioneering.core.market_simulator">
<span id="retentioneering-core-market-simulator-module"></span><h2>retentioneering.core.market_simulator module<a class="headerlink" href="#module-retentioneering.core.market_simulator" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="retentioneering.core.market_simulator.Agent">
<em class="property">class </em><code class="descclassname">retentioneering.core.market_simulator.</code><code class="descname">Agent</code><span class="sig-paren">(</span><em>state</em>, <em>adj</em>, <em>states_list</em>, <em>finance_data</em>, <em>atrans</em>, <em>aparams</em>, <em>plist</em>, <em>iters=1</em>, <em>atype=0</em>, <em>pad_len=-1</em>, <em>negative_event='lost'</em>, <em>positive_event='checkout'</em><span class="sig-paren">)</span><a class="headerlink" href="#retentioneering.core.market_simulator.Agent" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="method">
<dt id="retentioneering.core.market_simulator.Agent.gen_track">
<code class="descname">gen_track</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#retentioneering.core.market_simulator.Agent.gen_track" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="retentioneering.core.market_simulator.Agent.next_step">
<code class="descname">next_step</code><span class="sig-paren">(</span><em>state</em><span class="sig-paren">)</span><a class="headerlink" href="#retentioneering.core.market_simulator.Agent.next_step" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="staticmethod">
<dt id="retentioneering.core.market_simulator.Agent.normalize">
<em class="property">static </em><code class="descname">normalize</code><span class="sig-paren">(</span><em>v</em><span class="sig-paren">)</span><a class="headerlink" href="#retentioneering.core.market_simulator.Agent.normalize" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="retentioneering.core.market_simulator.Agent.step">
<code class="descname">step</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#retentioneering.core.market_simulator.Agent.step" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="retentioneering.core.market_simulator.Simulator">
<em class="property">class </em><code class="descclassname">retentioneering.core.market_simulator.</code><code class="descname">Simulator</code><span class="sig-paren">(</span><em>initial_state_list</em>, <em>adj_list</em>, <em>state_list</em>, <em>fin_data_list</em>, <em>atrans_list</em>, <em>aparms_list</em>, <em>plist_list</em>, <em>desired_ta</em>, <em>prev_story=[]</em>, <em>iters=100</em>, <em>negative_event='lost'</em>, <em>positive_event='checkout'</em><span class="sig-paren">)</span><a class="headerlink" href="#retentioneering.core.market_simulator.Simulator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="method">
<dt id="retentioneering.core.market_simulator.Simulator.add_agents">
<code class="descname">add_agents</code><span class="sig-paren">(</span><em>cntlist</em>, <em>nstep</em><span class="sig-paren">)</span><a class="headerlink" href="#retentioneering.core.market_simulator.Simulator.add_agents" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="retentioneering.core.market_simulator.Simulator.calc_states">
<code class="descname">calc_states</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#retentioneering.core.market_simulator.Simulator.calc_states" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="retentioneering.core.market_simulator.Simulator.extract_money">
<code class="descname">extract_money</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#retentioneering.core.market_simulator.Simulator.extract_money" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="retentioneering.core.market_simulator.Simulator.plot_simulation">
<code class="descname">plot_simulation</code><span class="sig-paren">(</span><em>m=None</em><span class="sig-paren">)</span><a class="headerlink" href="#retentioneering.core.market_simulator.Simulator.plot_simulation" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="retentioneering.core.market_simulator.Simulator.plot_users">
<code class="descname">plot_users</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#retentioneering.core.market_simulator.Simulator.plot_users" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="retentioneering.core.market_simulator.Simulator.plot_users_cumsum">
<code class="descname">plot_users_cumsum</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#retentioneering.core.market_simulator.Simulator.plot_users_cumsum" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="retentioneering.core.market_simulator.Simulator.return_simulation">
<code class="descname">return_simulation</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#retentioneering.core.market_simulator.Simulator.return_simulation" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-retentioneering.core.model">
<span id="retentioneering-core-model-module"></span><h2>retentioneering.core.model module<a class="headerlink" href="#module-retentioneering.core.model" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="retentioneering.core.model.ModelDescriptor">
<em class="property">class </em><code class="descclassname">retentioneering.core.model.</code><code class="descname">ModelDescriptor</code><span class="sig-paren">(</span><em>model</em>, <em>data</em>, <em>target</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#retentioneering.core.model.ModelDescriptor" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="method">
<dt id="retentioneering.core.model.ModelDescriptor.permutation_importance">
<code class="descname">permutation_importance</code><span class="sig-paren">(</span><em>test_sample</em>, <em>test_target</em>, <em>node_params=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#retentioneering.core.model.ModelDescriptor.permutation_importance" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates permutation importance of features.
If <code class="docutils literal notranslate"><span class="pre">node_params</span></code> is not <cite>None</cite>, then plots graph weighted by permutation importance.</p>
<dl class="docutils">
<dt>test_sample: pd.DataFrame</dt>
<dd>Test feature subsample.</dd>
<dt>test_target: np.array</dt>
<dd>Vector of targets for test sample.</dd>
<dt>node_params: dict, optional</dt>
<dd><dl class="first docutils">
<dt>Event mapping describing which nodes or edges should be highlighted by different colors for better visualisation. Dictionary keys are <code class="docutils literal notranslate"><span class="pre">event_col</span></code> values, while keys have the following possible values:</dt>
<dd><ul class="first last simple">
<li><code class="docutils literal notranslate"><span class="pre">bad_target</span></code>: highlights node and all incoming edges with red color;</li>
<li><code class="docutils literal notranslate"><span class="pre">nice_target</span></code>: highlights node and all incoming edges with green color;</li>
<li><code class="docutils literal notranslate"><span class="pre">bad_node</span></code>: highlights node with red color;</li>
<li><code class="docutils literal notranslate"><span class="pre">nice_node</span></code>: highlights node with green color;</li>
<li><code class="docutils literal notranslate"><span class="pre">source</span></code>: highlights node and all outgoing edges with yellow color.</li>
</ul>
</dd>
</dl>
<p>Example <code class="docutils literal notranslate"><span class="pre">node_params</span></code> is shown below:
<a href="#id1"><span class="problematic" id="id2">``</span></a>`
{</p>
<blockquote>
<div>‘lost’: ‘bad_target’,
‘purchased’: ‘nice_target’,
‘onboarding_welcome_screen’: ‘source’,
‘choose_login_type’: ‘nice_node’,
‘accept_privacy_policy’: ‘bad_node’,</div></blockquote>
<p>If <code class="docutils literal notranslate"><span class="pre">node_params=None</span></code>, it will be constructed from <code class="docutils literal notranslate"><span class="pre">retention_config</span></code> variable, so that:
<a href="#id3"><span class="problematic" id="id4">``</span></a>`
{</p>
<blockquote>
<div>‘positive_target_event’: ‘nice_target’,
‘negative_target_event’: ‘bad_target’,
‘source_event’: ‘source’,</div></blockquote>
<p class="last">Default: <code class="docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="retentioneering.core.model.ModelDescriptor.permutation_importance_raw">
<code class="descname">permutation_importance_raw</code><span class="sig-paren">(</span><em>test</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#retentioneering.core.model.ModelDescriptor.permutation_importance_raw" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="retentioneering.core.model.ModelDescriptor.predict">
<code class="descname">predict</code><span class="sig-paren">(</span><em>features</em><span class="sig-paren">)</span><a class="headerlink" href="#retentioneering.core.model.ModelDescriptor.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Predicts probability of <code class="docutils literal notranslate"><span class="pre">positive_target_event</span></code> and <code class="docutils literal notranslate"><span class="pre">negative_target_event</span></code> in classifacation task or values of <code class="docutils literal notranslate"><span class="pre">regeression_targets</span></code> in regression task.</p>
<dl class="docutils">
<dt>features: pd.DataFrame</dt>
<dd>Dataframe with test features. For more information refer to <code class="docutils literal notranslate"><span class="pre">prepare_test()</span></code> method.</dd>
</dl>
<p>Dataframe with predictions.</p>
<p>pd.DataFrame</p>
</dd></dl>

<dl class="method">
<dt id="retentioneering.core.model.ModelDescriptor.predict_raw">
<code class="descname">predict_raw</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span><a class="headerlink" href="#retentioneering.core.model.ModelDescriptor.predict_raw" title="Permalink to this definition">¶</a></dt>
<dd><p>Predicts probability of <code class="docutils literal notranslate"><span class="pre">positive_target_event</span></code> and <code class="docutils literal notranslate"><span class="pre">negative_target_event</span></code> in classifacation task or values of <code class="docutils literal notranslate"><span class="pre">regeression_targets</span></code> in regression task.</p>
<dl class="docutils">
<dt>data: pd.DataFrame</dt>
<dd>Raw clickstream.</dd>
</dl>
<p>Dataframe with predictions.</p>
<p>pd.DataFrame</p>
</dd></dl>

<dl class="method">
<dt id="retentioneering.core.model.ModelDescriptor.prepare_test">
<code class="descname">prepare_test</code><span class="sig-paren">(</span><em>test</em><span class="sig-paren">)</span><a class="headerlink" href="#retentioneering.core.model.ModelDescriptor.prepare_test" title="Permalink to this definition">¶</a></dt>
<dd><p>Transforms test clickstream into train.</p>
<dl class="docutils">
<dt>test: pd.DataFrame</dt>
<dd>Raw clickstream.</dd>
</dl>
<p>Dataframe with test features.</p>
<p>pd.DataFrame</p>
</dd></dl>

<dl class="method">
<dt id="retentioneering.core.model.ModelDescriptor.show_quality_metrics">
<code class="descname">show_quality_metrics</code><span class="sig-paren">(</span><em>test_sample</em>, <em>test_target</em>, <em>use_print=True</em><span class="sig-paren">)</span><a class="headerlink" href="#retentioneering.core.model.ModelDescriptor.show_quality_metrics" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate model quality metrics.</p>
<dl class="docutils">
<dt>test_sample: pd.DataFrame</dt>
<dd>Test feature subsample.</dd>
<dt>test_target: np.array</dt>
<dd>Vector of targets for test sample.</dd>
<dt>use_print: bool, optional</dt>
<dd>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, prints out ROC-AUC, PR-AUC and accuracy in prediction task and RMSE, MAE and R-Squared in regression task.</dd>
</dl>
<p>ROC-AUC, PR-AUC and accuracy metrics in prediction task and RMSE, MAE and R-Squared in regression task.</p>
<p>Int</p>
</dd></dl>

<dl class="method">
<dt id="retentioneering.core.model.ModelDescriptor.show_quality_raw">
<code class="descname">show_quality_raw</code><span class="sig-paren">(</span><em>test</em><span class="sig-paren">)</span><a class="headerlink" href="#retentioneering.core.model.ModelDescriptor.show_quality_raw" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="retentioneering.core.model.ModelDescriptor.visualize_results">
<code class="descname">visualize_results</code><span class="sig-paren">(</span><em>plot_type='projections'</em><span class="sig-paren">)</span><a class="headerlink" href="#retentioneering.core.model.ModelDescriptor.visualize_results" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-retentioneering.core.node_metrics">
<span id="retentioneering-core-node-metrics-module"></span><h2>retentioneering.core.node_metrics module<a class="headerlink" href="#module-retentioneering.core.node_metrics" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-retentioneering.core.preprocessing">
<span id="retentioneering-core-preprocessing-module"></span><h2>retentioneering.core.preprocessing module<a class="headerlink" href="#module-retentioneering.core.preprocessing" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="retentioneering.core.preprocessing.split_sessions">
<code class="descclassname">retentioneering.core.preprocessing.</code><code class="descname">split_sessions</code><span class="sig-paren">(</span><em>data</em>, <em>minimal_thresh=30</em>, <em>lower_filter=1</em>, <em>upper_filter=99</em><span class="sig-paren">)</span><a class="headerlink" href="#retentioneering.core.preprocessing.split_sessions" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates <code class="docutils literal notranslate"><span class="pre">session</span></code> column with session rank in given dataset.</p>
<dl class="docutils">
<dt>data: pd.DataFrame</dt>
<dd>Clickstream data.</dd>
<dt>minimal_thresh: int, optional</dt>
<dd>Minimal time difference in seconds between two sessions. If  threshold value of time difference between sessions is lower that <code class="docutils literal notranslate"><span class="pre">minimal_thresh</span></code>, then sessions are split based on this parameter. Default: <code class="docutils literal notranslate"><span class="pre">30</span></code></dd>
<dt>lower_filter: float, optional</dt>
<dd>Minimal percentile of time distribution between events to be considered as different sessions. For instance, equal to 1 would mean that cutoff time diffrecence between events (time difference between pseudosessions) should not be less than 1st percentile of time distribution between events. Range of possible values: [0, 100]. Default: <code class="docutils literal notranslate"><span class="pre">1</span></code></dd>
<dt>upper_filter: float, optional</dt>
<dd>Same as <code class="docutils literal notranslate"><span class="pre">lower_filter</span></code> but as an upper limit. Range of possible values: [0, 100]. Default: <code class="docutils literal notranslate"><span class="pre">99</span></code></dd>
</dl>
<p>Creates session column in dataset.</p>
<p>pd.DataFrame</p>
</dd></dl>

<dl class="function">
<dt id="retentioneering.core.preprocessing.weight_by_mechanics">
<code class="descclassname">retentioneering.core.preprocessing.</code><code class="descname">weight_by_mechanics</code><span class="sig-paren">(</span><em>data</em>, <em>main_event_map</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#retentioneering.core.preprocessing.weight_by_mechanics" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates weights of mechanics over <code class="docutils literal notranslate"><span class="pre">index_col</span></code>.</p>
<dl class="docutils">
<dt>data: pd.DataFrame</dt>
<dd>Сlickstream or features data.</dd>
<dt>main_event_map: dict</dt>
<dd>Mapping of main events into mechanics.</dd>
<dt>kwargs: optional</dt>
<dd><code class="docutils literal notranslate"><span class="pre">sklearn.decomposition.LatentDirichletAllocation()</span></code> and <code class="docutils literal notranslate"><span class="pre">BaseDataset.retention.extract_features()</span></code> parameters.</dd>
</dl>
<p>Weights of mechanics for each <code class="docutils literal notranslate"><span class="pre">index_col</span></code> and mechanics description.</p>
</dd></dl>

</div>
<div class="section" id="module-retentioneering.core.simulator">
<span id="retentioneering-core-simulator-module"></span><h2>retentioneering.core.simulator module<a class="headerlink" href="#module-retentioneering.core.simulator" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="retentioneering.core.simulator.Agent">
<em class="property">class </em><code class="descclassname">retentioneering.core.simulator.</code><code class="descname">Agent</code><span class="sig-paren">(</span><em>probs</em>, <em>user_type</em>, <em>restriction_pos</em>, <em>config=None</em>, <em>user_id=None</em><span class="sig-paren">)</span><a class="headerlink" href="#retentioneering.core.simulator.Agent" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="method">
<dt id="retentioneering.core.simulator.Agent.simulate">
<code class="descname">simulate</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#retentioneering.core.simulator.Agent.simulate" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="retentioneering.core.simulator.Simulator">
<em class="property">class </em><code class="descclassname">retentioneering.core.simulator.</code><code class="descname">Simulator</code><span class="sig-paren">(</span><em>restriction_graph</em>, <em>path=''</em>, <em>tables='dynamic_matrix'</em>, <em>num_pops=100</em><span class="sig-paren">)</span><a class="headerlink" href="#retentioneering.core.simulator.Simulator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="method">
<dt id="retentioneering.core.simulator.Simulator.create_population">
<code class="descname">create_population</code><span class="sig-paren">(</span><em>path</em>, <em>config</em>, <em>tables</em>, <em>num_pops</em><span class="sig-paren">)</span><a class="headerlink" href="#retentioneering.core.simulator.Simulator.create_population" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="retentioneering.core.simulator.Simulator.prepare_restriction_graph">
<code class="descname">prepare_restriction_graph</code><span class="sig-paren">(</span><em>graph</em><span class="sig-paren">)</span><a class="headerlink" href="#retentioneering.core.simulator.Simulator.prepare_restriction_graph" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="staticmethod">
<dt id="retentioneering.core.simulator.Simulator.prepare_step_matrix">
<em class="property">static </em><code class="descname">prepare_step_matrix</code><span class="sig-paren">(</span><em>mat</em><span class="sig-paren">)</span><a class="headerlink" href="#retentioneering.core.simulator.Simulator.prepare_step_matrix" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>mat</strong> – step matrix with dt_means</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">prepared matrix</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="retentioneering.core.simulator.Simulator.simulate">
<code class="descname">simulate</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#retentioneering.core.simulator.Simulator.simulate" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-retentioneering.core.tree_selector">
<span id="retentioneering-core-tree-selector-module"></span><h2>retentioneering.core.tree_selector module<a class="headerlink" href="#module-retentioneering.core.tree_selector" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="retentioneering.core.tree_selector.show_tree_filter">
<code class="descclassname">retentioneering.core.tree_selector.</code><code class="descname">show_tree_filter</code><span class="sig-paren">(</span><em>event_col</em>, <em>width=500</em>, <em>height=500</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#retentioneering.core.tree_selector.show_tree_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Shows tree selector for events filtering and aggregation, based on values in <code class="docutils literal notranslate"><span class="pre">event_col</span></code> column. It uses <cite>_</cite> for event names splitting, so ideally the event name structure in the dataset should include underscores and have a hierarchical, e.g. <code class="docutils literal notranslate"><span class="pre">[section]_[page]_[action]</span></code>. In this case event names are separated into levels, so that all the events with the same <code class="docutils literal notranslate"><span class="pre">[section]</span></code> will be placed under the same tree node, etc.
There two kind of checkboxes in tree selector: large blue and small white. The former are used to include or exclude event from original dataset. The latter are used for event aggregation: toggle on a checkbox against an event name level, e.g. a specific <code class="docutils literal notranslate"><span class="pre">[section]_[page]</span></code>, to aggregate all the underlying events, all the <code class="docutils literal notranslate"><span class="pre">[actions]</span></code> in this example, to this level.
Tree filter has a download button in the end of event list, which downloads a JSON config file, which you then need to use to filter and aggregate events with <code class="docutils literal notranslate"><span class="pre">use_tree_filter()</span></code> function.</p>
<dl class="docutils">
<dt>event_col: str</dt>
<dd>Column with event names.</dd>
<dt>width: int, optional</dt>
<dd>Width of IFrame in pixels.</dd>
<dt>height: int, optional</dt>
<dd>Height of IFrame in pixels.</dd>
</dl>
<p>Renders events tree selector</p>
<p>IFrame</p>
</dd></dl>

<dl class="function">
<dt id="retentioneering.core.tree_selector.use_tree_filter">
<code class="descclassname">retentioneering.core.tree_selector.</code><code class="descname">use_tree_filter</code><span class="sig-paren">(</span><em>data</em>, <em>path</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#retentioneering.core.tree_selector.use_tree_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Uses generated with <code class="docutils literal notranslate"><span class="pre">show_tree_filter()</span></code> JSON config to filter and aggregate <code class="docutils literal notranslate"><span class="pre">event_col</span></code> values of dataset.</p>
<dl class="docutils">
<dt>data: pd.DataFrame</dt>
<dd>Event dataset. Should include the same event column as in <code class="docutils literal notranslate"><span class="pre">event_col</span></code> of <code class="docutils literal notranslate"><span class="pre">retention_config</span></code>.</dd>
<dt>path: str</dt>
<dd>Path to JSON config file generated with <code class="docutils literal notranslate"><span class="pre">show_tree_filter()</span></code> function.</dd>
</dl>
<p>Filtered and aggregated dataset</p>
<p>pd.DataFrame</p>
</dd></dl>

</div>
<div class="section" id="module-retentioneering.core.utils">
<span id="retentioneering-core-utils-module"></span><h2>retentioneering.core.utils module<a class="headerlink" href="#module-retentioneering.core.utils" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="retentioneering.core.utils.BaseDataset">
<em class="property">class </em><code class="descclassname">retentioneering.core.utils.</code><code class="descname">BaseDataset</code><span class="sig-paren">(</span><em>pandas_obj</em><span class="sig-paren">)</span><a class="headerlink" href="#retentioneering.core.utils.BaseDataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#retentioneering.core.utils.BaseTrajectory" title="retentioneering.core.utils.BaseTrajectory"><code class="xref py py-class docutils literal notranslate"><span class="pre">retentioneering.core.utils.BaseTrajectory</span></code></a></p>
<dl class="method">
<dt id="retentioneering.core.utils.BaseDataset.add_eos">
<code class="descname">add_eos</code><span class="sig-paren">(</span><em>eos='lost'</em>, <em>thresh=28800</em>, <em>time_col=None</em>, <em>event_col=None</em>, <em>index_col=None</em><span class="sig-paren">)</span><a class="headerlink" href="#retentioneering.core.utils.BaseDataset.add_eos" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="retentioneering.core.utils.BaseDataset.apply_trajectory_filter">
<code class="descname">apply_trajectory_filter</code><span class="sig-paren">(</span><em>event_list</em>, <em>index_col=None</em>, <em>event_col=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#retentioneering.core.utils.BaseDataset.apply_trajectory_filter" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="retentioneering.core.utils.BaseDataset.calculate_delays">
<code class="descname">calculate_delays</code><span class="sig-paren">(</span><em>plotting=True</em>, <em>time_col=None</em>, <em>index_col=None</em>, <em>event_col=None</em>, <em>bins=50</em><span class="sig-paren">)</span><a class="headerlink" href="#retentioneering.core.utils.BaseDataset.calculate_delays" title="Permalink to this definition">¶</a></dt>
<dd><p>Displays the logarithm of delay between <code class="docutils literal notranslate"><span class="pre">time_col</span></code> with the next value in nanoseconds as a histogram.</p>
<dl class="docutils">
<dt>plotting: bool, optional</dt>
<dd>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, then histogram is plotted as a graph. Default: <code class="docutils literal notranslate"><span class="pre">True</span></code></dd>
<dt>time_col: str, optional</dt>
<dd>Name of custom time column for more information refer to <code class="docutils literal notranslate"><span class="pre">init_config</span></code>. For instance, if in config you have defined <code class="docutils literal notranslate"><span class="pre">event_time_col</span></code> as <code class="docutils literal notranslate"><span class="pre">server_timestamp</span></code>, but want to use function over <code class="docutils literal notranslate"><span class="pre">user_timestamp</span></code>. By default the column defined in <code class="docutils literal notranslate"><span class="pre">init_config</span></code> will be used as <code class="docutils literal notranslate"><span class="pre">time_col</span></code>.</dd>
<dt>index_col: str, optional</dt>
<dd>Name of custom index column, for more information refer to <code class="docutils literal notranslate"><span class="pre">init_config</span></code>. For instance, if in config you have defined <code class="docutils literal notranslate"><span class="pre">index_col</span></code> as <code class="docutils literal notranslate"><span class="pre">user_id</span></code>, but want to use function over sessions. By default the column defined in <code class="docutils literal notranslate"><span class="pre">init_config</span></code> will be used as <code class="docutils literal notranslate"><span class="pre">index_col</span></code>.</dd>
<dt>event_col: str, optional</dt>
<dd>Name of custom event column, for more information refer to <code class="docutils literal notranslate"><span class="pre">init_config</span></code>. For instance, you may want to aggregate some events or rename and use it as new event column. By default the column defined in <code class="docutils literal notranslate"><span class="pre">init_config</span></code> will be used as <code class="docutils literal notranslate"><span class="pre">event_col</span></code>.</dd>
<dt>bins: int, optional</dt>
<dd>Number of bins for visualisation. Default: <code class="docutils literal notranslate"><span class="pre">50</span></code></dd>
</dl>
<p>Delays in logarithm of nanoseconds for each <code class="docutils literal notranslate"><span class="pre">time_col</span></code>. Index is preserved as in original dataset.</p>
<p>List</p>
</dd></dl>

<dl class="method">
<dt id="retentioneering.core.utils.BaseDataset.cluster_event_dist">
<code class="descname">cluster_event_dist</code><span class="sig-paren">(</span><em>cl1</em>, <em>cl2=None</em>, <em>n=3</em>, <em>event_col=None</em>, <em>index_col=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#retentioneering.core.utils.BaseDataset.cluster_event_dist" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots frequency of top events in cluster <code class="docutils literal notranslate"><span class="pre">cl1</span></code> in comparison with frequency of such events in whole data or in cluster <code class="docutils literal notranslate"><span class="pre">cl2</span></code>.</p>
<dl class="docutils">
<dt>cl1: int</dt>
<dd>ID of the first cluster to search top events from it.</dd>
<dt>cl2: int, optional</dt>
<dd>ID of the second cluster to compare with top events from first cluster. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, then compares with all data. Default: <code class="docutils literal notranslate"><span class="pre">None</span></code></dd>
<dt>n: int, optional</dt>
<dd>Number of top events. Default: <code class="docutils literal notranslate"><span class="pre">3</span></code></dd>
<dt>index_col: str, optional</dt>
<dd>Name of custom index column, for more information refer to <code class="docutils literal notranslate"><span class="pre">init_config</span></code>. For instance, if in config you have defined <code class="docutils literal notranslate"><span class="pre">index_col</span></code> as <code class="docutils literal notranslate"><span class="pre">user_id</span></code>, but want to use function over sessions. By default the column defined in <code class="docutils literal notranslate"><span class="pre">init_config</span></code> will be used as <code class="docutils literal notranslate"><span class="pre">index_col</span></code>.</dd>
<dt>event_col: str, optional</dt>
<dd>Name of custom event column, for more information refer to <code class="docutils literal notranslate"><span class="pre">init_config</span></code>. For instance, you may want to aggregate some events or rename and use it as new event column. By default the column defined in <code class="docutils literal notranslate"><span class="pre">init_config</span></code> will be used as <code class="docutils literal notranslate"><span class="pre">event_col</span></code>.</dd>
</dl>
<p>Plots distribution barchart</p>
</dd></dl>

<dl class="method">
<dt id="retentioneering.core.utils.BaseDataset.cluster_funnel">
<code class="descname">cluster_funnel</code><span class="sig-paren">(</span><em>cluster</em>, <em>funnel_events</em>, <em>index_col=None</em>, <em>event_col=None</em>, <em>user_based=True</em>, <em>interactive=True</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#retentioneering.core.utils.BaseDataset.cluster_funnel" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots funnel over given event list as number of users who pass through each event</p>
<dl class="docutils">
<dt>cluster: int or list</dt>
<dd>Cluster ID or list of cluster IDs to create a funnel for.</dd>
<dt>funnel_events: list</dt>
<dd>List of event in funnel. Visualization order will be the same as in list.</dd>
<dt>user_based: bool, optional</dt>
<dd>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, then edge weights is calculated as unique rate of users who go through them, else as event count. Default: <code class="docutils literal notranslate"><span class="pre">True</span></code></dd>
<dt>index_col: str, optional</dt>
<dd>Name of custom index column, for more information refer to <code class="docutils literal notranslate"><span class="pre">init_config</span></code>. For instance, if in config you have defined <code class="docutils literal notranslate"><span class="pre">index_col</span></code> as <code class="docutils literal notranslate"><span class="pre">user_id</span></code>, but want to use function over sessions. By default the column defined in <code class="docutils literal notranslate"><span class="pre">init_config</span></code> will be used as <code class="docutils literal notranslate"><span class="pre">index_col</span></code>.</dd>
<dt>event_col: str, optional</dt>
<dd>Name of custom event column, for more information refer to <code class="docutils literal notranslate"><span class="pre">init_config</span></code>. For instance, you may want to aggregate some events or rename and use it as new event column. By default the column defined in <code class="docutils literal notranslate"><span class="pre">init_config</span></code> will be used as <code class="docutils literal notranslate"><span class="pre">event_col</span></code>.</dd>
</dl>
<p>Funnel visualisation</p>
<p>Plotly</p>
</dd></dl>

<dl class="method">
<dt id="retentioneering.core.utils.BaseDataset.cluster_top_events">
<code class="descname">cluster_top_events</code><span class="sig-paren">(</span><em>n=3</em><span class="sig-paren">)</span><a class="headerlink" href="#retentioneering.core.utils.BaseDataset.cluster_top_events" title="Permalink to this definition">¶</a></dt>
<dd><p>Shows most frequent <code class="docutils literal notranslate"><span class="pre">event_col</span></code> values for each cluster along with count and frequency of such events.</p>
<dl class="docutils">
<dt>n: int, optional</dt>
<dd>Number of most frequent events. Default: <code class="docutils literal notranslate"><span class="pre">3</span></code></dd>
</dl>
<p>Prints events statistics for each cluster in output.</p>
</dd></dl>

<dl class="method">
<dt id="retentioneering.core.utils.BaseDataset.core_event_distribution">
<code class="descname">core_event_distribution</code><span class="sig-paren">(</span><em>core_events</em>, <em>index_col=None</em>, <em>event_col=None</em>, <em>thresh=None</em>, <em>plotting=True</em>, <em>use_greater=True</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#retentioneering.core.utils.BaseDataset.core_event_distribution" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="retentioneering.core.utils.BaseDataset.create_filter">
<code class="descname">create_filter</code><span class="sig-paren">(</span><em>index_col=None</em>, <em>cluster_list=None</em>, <em>cluster_mapping=None</em><span class="sig-paren">)</span><a class="headerlink" href="#retentioneering.core.utils.BaseDataset.create_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates filter for <code class="docutils literal notranslate"><span class="pre">get_step_matrix_difference()</span></code> method based on target classes or clusters.</p>
<dl class="docutils">
<dt>index_col: str, optional</dt>
<dd>Name of custom index column, for more information refer to <code class="docutils literal notranslate"><span class="pre">init_config</span></code>. For instance, if in config you have defined <code class="docutils literal notranslate"><span class="pre">index_col</span></code> as <code class="docutils literal notranslate"><span class="pre">user_id</span></code>, but want to use function over sessions. By default the column defined in <code class="docutils literal notranslate"><span class="pre">init_config</span></code> will be used as <code class="docutils literal notranslate"><span class="pre">index_col</span></code>.</dd>
<dt>cluster_list: list, optional</dt>
<dd>List of clusters from which others will be substract. Default: <code class="docutils literal notranslate"><span class="pre">None</span></code></dd>
<dt>cluster_mapping: str, optional</dt>
<dd>Mapping from clusters to list of users. IMPORTANT: if you use cluster subsample of source data, then it will be necessary to set <code class="docutils literal notranslate"><span class="pre">cluster_mapping=source_data.retention.cluster_mapping</span></code>.</dd>
</dl>
<p>Boolean array with filter</p>
<p>Boolean pd.Series</p>
</dd></dl>

<dl class="method">
<dt id="retentioneering.core.utils.BaseDataset.create_model">
<code class="descname">create_model</code><span class="sig-paren">(</span><em>model_type=&lt;class 'sklearn.linear_model.logistic.LogisticRegression'&gt;</em>, <em>regression_targets=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#retentioneering.core.utils.BaseDataset.create_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates model explainer for a given model.</p>
<dl class="docutils">
<dt>model_type: sklearn class</dt>
<dd>Model class in sklearn-api style (should have methods <cite>fit</cite>, <cite>predict_proba</cite>).</dd>
<dt>regression_targets: dict, optional</dt>
<dd>Mapping from <code class="docutils literal notranslate"><span class="pre">index_col</span></code> to regression target e.g. LTV of user. Default: <code class="docutils literal notranslate"><span class="pre">None</span></code></dd>
<dt>kwargs:</dt>
<dd>Parameters for model class that you use, also contains parameters for <code class="docutils literal notranslate"><span class="pre">retention.extract_features()</span></code>.</dd>
</dl>
<p>Creates ModelDescriptor</p>
</dd></dl>

<dl class="method">
<dt id="retentioneering.core.utils.BaseDataset.create_trajectory_filter">
<code class="descname">create_trajectory_filter</code><span class="sig-paren">(</span><em>event_list</em>, <em>index_col=None</em>, <em>event_col=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#retentioneering.core.utils.BaseDataset.create_trajectory_filter" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="retentioneering.core.utils.BaseDataset.extract_features">
<code class="descname">extract_features</code><span class="sig-paren">(</span><em>feature_type='tfidf'</em>, <em>drop_targets=True</em>, <em>metadata=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#retentioneering.core.utils.BaseDataset.extract_features" title="Permalink to this definition">¶</a></dt>
<dd><p>User trajectories vectorizer.</p>
<dl class="docutils">
<dt>feature_type: str, optional</dt>
<dd>Type of vectorizer. Available vectorization methods:
- TFIDF (<code class="docutils literal notranslate"><span class="pre">feature_type='tfidf'</span></code>). For more information refer to <code class="docutils literal notranslate"><span class="pre">retentioneering.core.feature_extraction.tfidf_embedder</span></code>.
- Event frequencies (<code class="docutils literal notranslate"><span class="pre">feature_type='frequency'</span></code>). For more information refer to <code class="docutils literal notranslate"><span class="pre">retentioneering.core.feature_extraction.frequency_embedder</span></code>.
- Event counts (<code class="docutils literal notranslate"><span class="pre">feature_type='counts'</span></code>). For more information refer to <code class="docutils literal notranslate"><span class="pre">counts_embedder</span></code>.
Default: <code class="docutils literal notranslate"><span class="pre">tfidf</span></code></dd>
<dt>drop_targets: bool, optional</dt>
<dd>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, then targets will be removed from feature generation. Default: <code class="docutils literal notranslate"><span class="pre">True</span></code></dd>
<dt>metadata: pd.DataFrame, optional</dt>
<dd>Dataframe with user or session properties or any other information you would like to extract as features (e.g. user properties, LTV values, etc.). Default: <code class="docutils literal notranslate"><span class="pre">None</span></code></dd>
<dt>meta_index_col: str, optional</dt>
<dd>Used when metadata is not <code class="docutils literal notranslate"><span class="pre">None</span></code>. Name of column in <code class="docutils literal notranslate"><span class="pre">metadata</span></code> dataframe that contains the same ID as in <code class="docutils literal notranslate"><span class="pre">index_col</span></code>, or if not defined, same as in retention_config (e.g ID of users or sessions). If <code class="docutils literal notranslate"><span class="pre">None</span></code>, then index of metadata dataframe is used instead. Default: <code class="docutils literal notranslate"><span class="pre">None</span></code></dd>
<dt>manifold_type: str, optional</dt>
<dd>Name dimensionality reduction method from <code class="docutils literal notranslate"><span class="pre">sklearn.decomposition</span></code> and <code class="docutils literal notranslate"><span class="pre">sklearn.manifold</span></code>. Default: <code class="docutils literal notranslate"><span class="pre">None</span></code></dd>
<dt>fillna: optional</dt>
<dd>Value for filling missing metadata for any <code class="docutils literal notranslate"><span class="pre">index_col</span></code> value. Default: <code class="docutils literal notranslate"><span class="pre">None</span></code></dd>
<dt>drop: bool, optional</dt>
<dd>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, then drops users which do not exist in <code class="docutils literal notranslate"><span class="pre">metadata</span></code> dataframe. Default: <code class="docutils literal notranslate"><span class="pre">False</span></code></dd>
<dt>ngram_range: tuple, optional</dt>
<dd>Range of ngrams to use in feature extraction. Default: <code class="docutils literal notranslate"><span class="pre">(1,</span> <span class="pre">1)</span></code></dd>
<dt>index_col: str, optional</dt>
<dd>Name of custom index column, for more information refer to <code class="docutils literal notranslate"><span class="pre">init_config</span></code>. For instance, if in config you have defined <code class="docutils literal notranslate"><span class="pre">index_col</span></code> as <code class="docutils literal notranslate"><span class="pre">user_id</span></code>, but want to use function over sessions. By default the column defined in <code class="docutils literal notranslate"><span class="pre">init_config</span></code> will be used as <code class="docutils literal notranslate"><span class="pre">index_col</span></code>.</dd>
<dt>event_col: str, optional</dt>
<dd>Name of custom event column, for more information refer to <code class="docutils literal notranslate"><span class="pre">init_config</span></code>. For instance, you may want to aggregate some events or rename and use it as new event column. By default the column defined in <code class="docutils literal notranslate"><span class="pre">init_config</span></code> will be used as <code class="docutils literal notranslate"><span class="pre">event_col</span></code>.</dd>
<dt>kwargs: optional</dt>
<dd>Keyword arguments for <code class="docutils literal notranslate"><span class="pre">sklearn.decomposition</span></code> and <code class="docutils literal notranslate"><span class="pre">sklearn.manifold</span></code> methods.</dd>
</dl>
<p>Encoded user trajectories</p>
<p>pd.DataFrame of (number of users, number of unique events | event n-grams)</p>
</dd></dl>

<dl class="method">
<dt id="retentioneering.core.utils.BaseDataset.extract_features_from_test">
<code class="descname">extract_features_from_test</code><span class="sig-paren">(</span><em>test</em>, <em>train=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#retentioneering.core.utils.BaseDataset.extract_features_from_test" title="Permalink to this definition">¶</a></dt>
<dd><p>Extracts features from test dataset</p>
<dl class="docutils">
<dt>test: pd.DataFrame</dt>
<dd>Test subsample of clickstream</dd>
<dt>train: pd.DataFrame, optional</dt>
<dd>Train subsample of clickstream</dd>
<dt>kwargs:</dt>
<dd><code class="docutils literal notranslate"><span class="pre">BaseDataset.retention.extract_features()</span></code> parameters.</dd>
</dl>
<p>Encoded user trajectories.</p>
<p>pd.DataFrame of (number of users in test, number of unique events | event n-grams in train)</p>
</dd></dl>

<dl class="method">
<dt id="retentioneering.core.utils.BaseDataset.filter_cluster">
<code class="descname">filter_cluster</code><span class="sig-paren">(</span><em>cluster_name</em>, <em>index_col=None</em><span class="sig-paren">)</span><a class="headerlink" href="#retentioneering.core.utils.BaseDataset.filter_cluster" title="Permalink to this definition">¶</a></dt>
<dd><p>Filters dataset against one or several clusters.</p>
<dl class="docutils">
<dt>cluster_name: int or list</dt>
<dd>Cluster ID or list of cluster IDs for filtering.</dd>
<dt>index_col: str, optional</dt>
<dd>Name of custom index column, for more information refer to <code class="docutils literal notranslate"><span class="pre">init_config</span></code>. For instance, if in config you have defined <code class="docutils literal notranslate"><span class="pre">index_col</span></code> as <code class="docutils literal notranslate"><span class="pre">user_id</span></code>, but want to use function over sessions. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, the column defined in <code class="docutils literal notranslate"><span class="pre">init_config</span></code> will be used as <code class="docutils literal notranslate"><span class="pre">index_col</span></code>. Default: <code class="docutils literal notranslate"><span class="pre">None</span></code></dd>
</dl>
<p>Filtered dataset</p>
<p>pd.Dataframe</p>
</dd></dl>

<dl class="method">
<dt id="retentioneering.core.utils.BaseDataset.filter_event_window">
<code class="descname">filter_event_window</code><span class="sig-paren">(</span><em>event_name</em>, <em>neighbor_range=3</em>, <em>event_col=None</em>, <em>index_col=None</em>, <em>use_padding=True</em><span class="sig-paren">)</span><a class="headerlink" href="#retentioneering.core.utils.BaseDataset.filter_event_window" title="Permalink to this definition">¶</a></dt>
<dd><p>Filters clickstream data for specific event and its neighborhood.</p>
<dl class="docutils">
<dt>event_name: str</dt>
<dd>Event of interest.</dd>
<dt>neighbor_range:</dt>
<dd>Number of events to the left and right from event of interest. Default: <code class="docutils literal notranslate"><span class="pre">3</span></code></dd>
<dt>index_col: str, optional</dt>
<dd>Name of custom index column, for more information refer to <code class="docutils literal notranslate"><span class="pre">init_config</span></code>. For instance, if in config you have defined <code class="docutils literal notranslate"><span class="pre">index_col</span></code> as <code class="docutils literal notranslate"><span class="pre">user_id</span></code>, but want to use function over sessions. By default the column defined in <code class="docutils literal notranslate"><span class="pre">init_config</span></code> will be used as <code class="docutils literal notranslate"><span class="pre">index_col</span></code>.</dd>
<dt>event_col: str, optional</dt>
<dd>Name of custom event column, for more information refer to <code class="docutils literal notranslate"><span class="pre">init_config</span></code>. For instance, you may want to aggregate some events or rename and use it as new event column. By default the column defined in <code class="docutils literal notranslate"><span class="pre">init_config</span></code> will be used as <code class="docutils literal notranslate"><span class="pre">event_col</span></code>.</dd>
<dt>use_padding: bool, optional</dt>
<dd>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, then all tracks are alligned with <cite>sleep</cite> event. After allignment all first <cite>event_name</cite> in a trajectory will be at a point <cite>neighbor_range + 1</cite></dd>
</dl>
<p>Filtered dataframe</p>
<p>pd.DataFrame</p>
</dd></dl>

<dl class="method">
<dt id="retentioneering.core.utils.BaseDataset.get_clusters">
<code class="descname">get_clusters</code><span class="sig-paren">(</span><em>plot_type=None</em>, <em>refit_cluster=False</em>, <em>method='simple_cluster'</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#retentioneering.core.utils.BaseDataset.get_clusters" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds clusters of users in data.</p>
<dl class="docutils">
<dt>plot_type: str, optional</dt>
<dd>Type of clustering visualization. Available methods are <code class="docutils literal notranslate"><span class="pre">cluster_heatmap</span></code>, <code class="docutils literal notranslate"><span class="pre">cluster_tsne</span></code>, <code class="docutils literal notranslate"><span class="pre">cluster_pie</span></code>, <code class="docutils literal notranslate"><span class="pre">cluster_bar</span></code>. Please, see examples to understand different visualization methods. Default: <code class="docutils literal notranslate"><span class="pre">None</span></code></dd>
<dt>refit_cluster: bool, optional</dt>
<dd>If <code class="docutils literal notranslate"><span class="pre">False</span></code>, then cached results of clustering are used. Default: <code class="docutils literal notranslate"><span class="pre">False</span></code></dd>
<dt>method: str, optional</dt>
<dd><dl class="first docutils">
<dt>Method of clustering. Available methods:</dt>
<dd><ul class="first last simple">
<li><code class="docutils literal notranslate"><span class="pre">simple_cluster</span></code>;</li>
<li><code class="docutils literal notranslate"><span class="pre">dbscan</span></code>;</li>
<li><code class="docutils literal notranslate"><span class="pre">GMM</span></code>.</li>
</ul>
</dd>
</dl>
<p class="last">Default: <code class="docutils literal notranslate"><span class="pre">simple_cluster</span></code></p>
</dd>
<dt>use_csi: bool, optional</dt>
<dd>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, then cluster stability index will be calculated. IMPORTANT: it may take a lot of time. Default: <code class="docutils literal notranslate"><span class="pre">True</span></code></dd>
<dt>epsq: float, optional</dt>
<dd>Quantile of nearest neighbor positive distance between dots, its value will be an eps. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, then eps from keywords will be used. Default: <code class="docutils literal notranslate"><span class="pre">None</span></code></dd>
<dt>max_cl_number: int, optional</dt>
<dd>Maximal number of clusters for aggregation of small clusters. Default: <code class="docutils literal notranslate"><span class="pre">None</span></code></dd>
<dt>max_n_clusters: int, optional</dt>
<dd>Maximal number of clusters for automatic selection for number of clusters. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, then uses n_clusters from arguments. Default: <cite>None``</cite></dd>
<dt>random_state: int, optional</dt>
<dd>Random state for KMeans and GMM clusterers.</dd>
<dt>feature_type: str, optional</dt>
<dd>Type of vectorizer. Available vectorization methods:
- TFIDF (<code class="docutils literal notranslate"><span class="pre">feature_type='tfidf'</span></code>). For more information refer to <code class="docutils literal notranslate"><span class="pre">retentioneering.core.feature_extraction.tfidf_embedder</span></code>.
- Event frequencies (<code class="docutils literal notranslate"><span class="pre">feature_type='frequency'</span></code>). For more information refer to <code class="docutils literal notranslate"><span class="pre">retentioneering.core.feature_extraction.frequency_embedder</span></code>.
- Event counts (<code class="docutils literal notranslate"><span class="pre">feature_type='counts'</span></code>). For more information refer to <code class="docutils literal notranslate"><span class="pre">counts_embedder</span></code>.
Default: <code class="docutils literal notranslate"><span class="pre">tfidf</span></code></dd>
<dt>drop_targets: bool, optional</dt>
<dd>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, then targets will be removed from feature generation. Default: <code class="docutils literal notranslate"><span class="pre">True</span></code></dd>
<dt>metadata: pd.DataFrame, optional</dt>
<dd>Dataframe with user or session properties or any other information you would like to extract as features (e.g. user properties, LTV values, etc.). Default: <code class="docutils literal notranslate"><span class="pre">None</span></code></dd>
<dt>meta_index_col: str, optional</dt>
<dd>Used when metadata is not <code class="docutils literal notranslate"><span class="pre">None</span></code>. Name of column in <code class="docutils literal notranslate"><span class="pre">metadata</span></code> dataframe that contains the same ID as in <code class="docutils literal notranslate"><span class="pre">index_col</span></code>, or if not defined, same as in retention_config (e.g ID of users or sessions). If <code class="docutils literal notranslate"><span class="pre">None</span></code>, then index of metadata dataframe is used instead. Default: <code class="docutils literal notranslate"><span class="pre">None</span></code></dd>
<dt>manifold_type: str, optional</dt>
<dd>Name dimensionality reduction method from <code class="docutils literal notranslate"><span class="pre">sklearn.decomposition</span></code> and <code class="docutils literal notranslate"><span class="pre">sklearn.manifold</span></code>. Default: <code class="docutils literal notranslate"><span class="pre">None</span></code></dd>
<dt>fillna: optional</dt>
<dd>Value for filling missing metadata for any <code class="docutils literal notranslate"><span class="pre">index_col</span></code> value. Default: <code class="docutils literal notranslate"><span class="pre">None</span></code></dd>
<dt>drop: bool, optional</dt>
<dd>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, then drops users which do not exist in <code class="docutils literal notranslate"><span class="pre">metadata</span></code> dataframe. Default: <code class="docutils literal notranslate"><span class="pre">False</span></code></dd>
<dt>ngram_range: tuple, optional</dt>
<dd>Range of ngrams to use in feature extraction. Default: <code class="docutils literal notranslate"><span class="pre">(1,</span> <span class="pre">1)</span></code></dd>
<dt>index_col:</dt>
<dd>Name of custom index column, for more information refer to <code class="docutils literal notranslate"><span class="pre">init_config</span></code>. For instance, if in config you have defined <code class="docutils literal notranslate"><span class="pre">index_col</span></code> as <code class="docutils literal notranslate"><span class="pre">user_id</span></code>, but want to use function over sessions. By default the column defined in <code class="docutils literal notranslate"><span class="pre">init_config</span></code> will be used as <code class="docutils literal notranslate"><span class="pre">index_col</span></code>.</dd>
<dt>event_col:</dt>
<dd>Name of custom event column, for more information refer to <code class="docutils literal notranslate"><span class="pre">init_config</span></code>. For instance, you may want to aggregate some events or rename and use it as new event column. By default the column defined in <code class="docutils literal notranslate"><span class="pre">init_config</span></code> will be used as <code class="docutils literal notranslate"><span class="pre">event_col</span></code>.</dd>
<dt>kwargs:</dt>
<dd>Parameters for <code class="docutils literal notranslate"><span class="pre">sklearn.decomposition()</span></code> and <code class="docutils literal notranslate"><span class="pre">sklearn.manifold()</span></code> methods. Keyword arguments for clusterers. For more information, please, see <code class="docutils literal notranslate"><span class="pre">sklearn.cluster.KMeans()</span></code>, <code class="docutils literal notranslate"><span class="pre">sklearn.cluster.DBSCAN()</span></code>, <code class="docutils literal notranslate"><span class="pre">sklearn.mixture.GaussianMixture()</span></code> docs.</dd>
</dl>
<p>Array of clusters</p>
<p>np.array</p>
</dd></dl>

<dl class="method">
<dt id="retentioneering.core.utils.BaseDataset.get_positive_users">
<code class="descname">get_positive_users</code><span class="sig-paren">(</span><em>index_col=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#retentioneering.core.utils.BaseDataset.get_positive_users" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns users who have <code class="docutils literal notranslate"><span class="pre">positive_target_event</span></code> in their trajectories.</p>
<dl class="docutils">
<dt>index_col: str, optional</dt>
<dd>Name of custom index column, for more information refer to <code class="docutils literal notranslate"><span class="pre">init_config</span></code>. For instance, if in config you have defined <code class="docutils literal notranslate"><span class="pre">index_col</span></code> as <code class="docutils literal notranslate"><span class="pre">user_id</span></code>, but want to use function over sessions. By default the column defined in <code class="docutils literal notranslate"><span class="pre">init_config</span></code> will be used as <code class="docutils literal notranslate"><span class="pre">index_col</span></code>.</dd>
</dl>
<p>Array of users with <code class="docutils literal notranslate"><span class="pre">positive_target_event</span></code> in trajectory.</p>
<p>np.array</p>
</dd></dl>

<dl class="method">
<dt id="retentioneering.core.utils.BaseDataset.get_step_matrix_difference">
<code class="descname">get_step_matrix_difference</code><span class="sig-paren">(</span><em>groups</em>, <em>plot_type=True</em>, <em>max_steps=30</em>, <em>sorting=True</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#retentioneering.core.utils.BaseDataset.get_step_matrix_difference" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots heatmap similar to <code class="docutils literal notranslate"><span class="pre">get_step_matrix()</span></code> matrix but with difference of events distributions over steps between two given groups.</p>
<dl class="docutils">
<dt>groups: boolean pd.Series</dt>
<dd>Boolean vector that splits data into groups. For more information refer to <code class="docutils literal notranslate"><span class="pre">create_filter()</span></code> method.</dd>
<dt>max_steps: int, optional</dt>
<dd>Maximum number of steps in trajectory to include. Depending on <code class="docutils literal notranslate"><span class="pre">reverse</span></code> parameter value, the steps are counted from the beginning of trajectories if <code class="docutils literal notranslate"><span class="pre">reverse=False</span></code>, or from the end otherwise.</dd>
<dt>plot_type: bool, optional</dt>
<dd>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, then plots step matrix in interactive session (Jupyter notebook). Default: <code class="docutils literal notranslate"><span class="pre">True</span></code></dd>
<dt>thr: float, optional</dt>
<dd>Used to prune matrix and display only the rows with at least one value &gt;= <code class="docutils literal notranslate"><span class="pre">thr</span></code>. Default: <code class="docutils literal notranslate"><span class="pre">None</span></code></dd>
<dt>reverse: str or list, optional</dt>
<dd><p class="first">This parameter is used to display reversed matrix from target events towards the beginning of trajectories.
Range of possible values:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">None</span></code>: displays default step matrix from the start of trajectories. Uses all the user trajectories.</li>
<li><code class="docutils literal notranslate"><span class="pre">'pos'</span></code>: displays reverse step matrix in such a way that the first column is the <code class="docutils literal notranslate"><span class="pre">positive_target_event</span></code> share, which is always 1, and the following columns reflect the share of users on final steps before reaching the target. Uses only those trajectories, which ended up having at least one <code class="docutils literal notranslate"><span class="pre">positive_target_event</span></code> in trajectory.</li>
<li><code class="docutils literal notranslate"><span class="pre">'neg'</span></code>: same as <code class="docutils literal notranslate"><span class="pre">pos</span></code> but for <code class="docutils literal notranslate"><span class="pre">negative_target_event</span></code>. Uses only those trajectories, which ended up having at least one <code class="docutils literal notranslate"><span class="pre">negative_target_event</span></code> in trajectory.</li>
<li><code class="docutils literal notranslate"><span class="pre">['pos',</span> <span class="pre">'neg']</span></code>: combination of <code class="docutils literal notranslate"><span class="pre">pos</span></code> and <code class="docutils literal notranslate"><span class="pre">neg</span></code> options, first column has only target events. Uses all the trajectories with target events inside.</li>
</ul>
</div></blockquote>
<p class="last">Default: <code class="docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
<dt>sorting: bool, optional</dt>
<dd>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, then automatically places elements with highest values in top. Rows are sorted in such a way that the first one has highest first column value, second row has the highest second column value,besides already used first value, etc. With this sorting you may see a dominant trajectory as a diagonal. Default: <code class="docutils literal notranslate"><span class="pre">True</span></code></dd>
<dt>index_col: str, optional</dt>
<dd>Name of custom index column, for more information refer to <code class="docutils literal notranslate"><span class="pre">init_config</span></code>. For instance, if in config you have defined <code class="docutils literal notranslate"><span class="pre">index_col</span></code> as <code class="docutils literal notranslate"><span class="pre">user_id</span></code>, but want to use function over sessions. By default the column defined in <code class="docutils literal notranslate"><span class="pre">init_config</span></code> will be used as <code class="docutils literal notranslate"><span class="pre">index_col</span></code>.</dd>
<dt>event_col: str, optional</dt>
<dd>Name of custom event column, for more information refer to <code class="docutils literal notranslate"><span class="pre">init_config</span></code>. For instance, you may want to aggregate some events or rename and use it as new event column. By default the column defined in <code class="docutils literal notranslate"><span class="pre">init_config</span></code> will be used as <code class="docutils literal notranslate"><span class="pre">event_col</span></code>.</dd>
<dt>cols: list or str</dt>
<dd>List of source and target columns, e.g. <code class="docutils literal notranslate"><span class="pre">event_name</span></code> and <code class="docutils literal notranslate"><span class="pre">next_event</span></code>. <code class="docutils literal notranslate"><span class="pre">next_event</span></code> column is created automatically during <code class="docutils literal notranslate"><span class="pre">BaseTrajectory.retention.prepare()</span></code> method execution. Default: <code class="docutils literal notranslate"><span class="pre">None</span></code> wich corresponds to <code class="docutils literal notranslate"><span class="pre">event_col</span></code> value from <code class="docutils literal notranslate"><span class="pre">retention_config</span></code> and ‘next_event’.</dd>
<dt>edge_col: str, optional</dt>
<dd>Aggregation column for edge weighting. For instance, you may set it to the same value as in <code class="docutils literal notranslate"><span class="pre">index_col</span></code> and define <code class="docutils literal notranslate"><span class="pre">edge_attributes='users_unique'</span></code> to calculate unique users passed through edge. Default: <code class="docutils literal notranslate"><span class="pre">None</span></code></dd>
<dt>edge_attributes: str, optional</dt>
<dd>Edge weighting function and the name of field is defined with this parameter. It is set with two parts and a dash inbetween: <code class="docutils literal notranslate"><span class="pre">[this_column_name]_[aggregation_function]</span></code>. The first part is the custom name of this field. The second part after <cite>_</cite> should be a valid <code class="docutils literal notranslate"><span class="pre">pandas.groupby.agg()</span></code> parameter, e.g. <code class="docutils literal notranslate"><span class="pre">count</span></code>, <code class="docutils literal notranslate"><span class="pre">sum</span></code>, <code class="docutils literal notranslate"><span class="pre">nunique</span></code>, etc. Default: <code class="docutils literal notranslate"><span class="pre">event_count</span></code>.</dd>
<dt>dt_means: bool, optional</dt>
<dd>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, adds mean time between events to step matrix. Default: <code class="docutils literal notranslate"><span class="pre">False</span></code></dd>
<dt>title: str, optional</dt>
<dd>Title for step matrix plot.</dd>
</dl>
<p>Dataframe with <code class="docutils literal notranslate"><span class="pre">max_steps</span></code> number of columns and len(event_col.unique) number of rows at max, or less if used <code class="docutils literal notranslate"><span class="pre">thr</span></code> &gt; 0.</p>
<p>pd.DataFrame</p>
</dd></dl>

<dl class="method">
<dt id="retentioneering.core.utils.BaseDataset.index_based_split">
<code class="descname">index_based_split</code><span class="sig-paren">(</span><em>index_col=None</em>, <em>test_size=0.2</em>, <em>seed=0</em><span class="sig-paren">)</span><a class="headerlink" href="#retentioneering.core.utils.BaseDataset.index_based_split" title="Permalink to this definition">¶</a></dt>
<dd><p>Splits dataset between train and test based on <code class="docutils literal notranslate"><span class="pre">index_col</span></code>.</p>
<dl class="docutils">
<dt>index_col: str, optional</dt>
<dd>Name of custom index column, for more information refer to <code class="docutils literal notranslate"><span class="pre">init_config</span></code>. For instance, if in config you have defined <code class="docutils literal notranslate"><span class="pre">index_col</span></code> as <code class="docutils literal notranslate"><span class="pre">user_id</span></code>, but want to use function over sessions. By default the column defined in <code class="docutils literal notranslate"><span class="pre">init_config</span></code> will be used as <code class="docutils literal notranslate"><span class="pre">index_col</span></code>.</dd>
<dt>test_size: float, optional</dt>
<dd>Rate of test subsample from 0 to 1. Default: <code class="docutils literal notranslate"><span class="pre">0.2</span></code></dd>
<dt>seed: int, optional</dt>
<dd>Random seed number. Default: <code class="docutils literal notranslate"><span class="pre">0</span></code></dd>
</dl>
<p>Two dataframes: train and test.</p>
<p>pd.DataFrame</p>
</dd></dl>

<dl class="method">
<dt id="retentioneering.core.utils.BaseDataset.insert_sleep_events">
<code class="descname">insert_sleep_events</code><span class="sig-paren">(</span><em>events</em>, <em>delays=None</em>, <em>time_col=None</em>, <em>index_col=None</em>, <em>event_col=None</em><span class="sig-paren">)</span><a class="headerlink" href="#retentioneering.core.utils.BaseDataset.insert_sleep_events" title="Permalink to this definition">¶</a></dt>
<dd><p>Populates given dataset with sleep events representing time difference between occuring events. Note that this method is not inplace.</p>
<dl class="docutils">
<dt>events: dict</dt>
<dd>Event name and log nanosecond ranges in the following structure: <code class="docutils literal notranslate"><span class="pre">'event_name'</span> <span class="pre">:</span> <span class="pre">['from_logtime',</span> <span class="pre">'to_logtime']</span></code>. Keys of the dictionary are custom event names, while values are lists of two floats indicating start and end of time difference in lorarithm nanoseconds.</dd>
<dt>delays: list</dt>
<dd>Timestamp differences of each event with the next one. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, then uses <code class="docutils literal notranslate"><span class="pre">BaseDataset.retention.calculate_delays()</span></code>. Default: <code class="docutils literal notranslate"><span class="pre">None</span></code></dd>
<dt>time_col: str, optional</dt>
<dd>Name of custom time column for more information refer to <code class="docutils literal notranslate"><span class="pre">init_config</span></code>. For instance, if in config you have defined <code class="docutils literal notranslate"><span class="pre">event_time_col</span></code> as <code class="docutils literal notranslate"><span class="pre">server_timestamp</span></code>, but want to use function over <code class="docutils literal notranslate"><span class="pre">user_timestamp</span></code>. By default the column defined in <code class="docutils literal notranslate"><span class="pre">init_config</span></code> will be used as <code class="docutils literal notranslate"><span class="pre">time_col</span></code>.</dd>
<dt>index_col: str, optional</dt>
<dd>Name of custom index column, for more information refer to <code class="docutils literal notranslate"><span class="pre">init_config</span></code>. For instance, if in config you have defined <code class="docutils literal notranslate"><span class="pre">index_col</span></code> as <code class="docutils literal notranslate"><span class="pre">user_id</span></code>, but want to use function over sessions. By default the column defined in <code class="docutils literal notranslate"><span class="pre">init_config</span></code> will be used as <code class="docutils literal notranslate"><span class="pre">index_col</span></code>.</dd>
<dt>event_col:  str, optional</dt>
<dd>Name of custom event column, for more information refer to <code class="docutils literal notranslate"><span class="pre">init_config</span></code>. For instance, you may want to aggregate some events or rename and use it as new event column. By default the column defined in <code class="docutils literal notranslate"><span class="pre">init_config</span></code> will be used as <code class="docutils literal notranslate"><span class="pre">event_col</span></code>.</dd>
</dl>
<p>Original dataframe with inserted sleep events.</p>
<p>pd.DataFrame</p>
</dd></dl>

<dl class="method">
<dt id="retentioneering.core.utils.BaseDataset.learn_tsne">
<code class="descname">learn_tsne</code><span class="sig-paren">(</span><em>targets=None</em>, <em>plot_type=None</em>, <em>refit=False</em>, <em>regression_targets=None</em>, <em>sample_size=None</em>, <em>sample_frac=None</em>, <em>proj_type=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#retentioneering.core.utils.BaseDataset.learn_tsne" title="Permalink to this definition">¶</a></dt>
<dd><p>Learns TSNE projection for selected feature space (<cite>feature_type</cite> in kwargs) and visualizes it with chosen visualization type.</p>
<dl class="docutils">
<dt>targets: np.array, optional</dt>
<dd>Vector of targets for users. if None, then calculates automatically based on <code class="docutils literal notranslate"><span class="pre">positive_target_event</span></code> and <code class="docutils literal notranslate"><span class="pre">negative_target_event</span></code>.</dd>
<dt>plot_type: str, optional</dt>
<dd><dl class="first docutils">
<dt>Type of projection visualization:</dt>
<dd><ul class="first last simple">
<li><code class="docutils literal notranslate"><span class="pre">clusters</span></code>: colors trajectories with different colors depending on cluster number.</li>
<li><code class="docutils literal notranslate"><span class="pre">targets</span></code>: color trajectories based on target reach.</li>
</ul>
</dd>
</dl>
<p class="last">If <code class="docutils literal notranslate"><span class="pre">None</span></code>, then only calculates TSNE without visualization. Default: <code class="docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
<dt>refit: bool, optional</dt>
<dd>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, then TSNE will be refitted, e.g. it is needed if you perform hyperparameters selection.</dd>
<dt>regression_targets: dict, optional</dt>
<dd>Mapping of <code class="docutils literal notranslate"><span class="pre">index_col</span></code> to regression target for custom coloring. For example, if you want to visually evaluate average LTV of user with trajectories clusterization. For more information refer to <code class="docutils literal notranslate"><span class="pre">BaseDataset.retention.make_regression_targets()</span></code>.</dd>
<dt>cmethod: str, optional</dt>
<dd>Method of clustering if plot_type = ‘clusters’. Refer to <code class="docutils literal notranslate"><span class="pre">BaseDataset.retention.get_clusters()</span></code> for more information.</dd>
<dt>kwargs: optional</dt>
<dd>Parameters for <code class="docutils literal notranslate"><span class="pre">BaseDataset.retention.extract_features()</span></code>, <code class="docutils literal notranslate"><span class="pre">sklearn.manifold.TSNE</span></code> and <code class="docutils literal notranslate"><span class="pre">BaseDataset.retention.get_clusters()</span></code></dd>
</dl>
<p>Dataframe with TSNE transform for user trajectories indexed by user IDs.</p>
<p>pd.DataFrame</p>
</dd></dl>

<dl class="staticmethod">
<dt id="retentioneering.core.utils.BaseDataset.make_regression_targets">
<em class="property">static </em><code class="descname">make_regression_targets</code><span class="sig-paren">(</span><em>features</em>, <em>regression_targets</em><span class="sig-paren">)</span><a class="headerlink" href="#retentioneering.core.utils.BaseDataset.make_regression_targets" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates target vector for given features.</p>
<dl class="docutils">
<dt>features: pd.DataFrame</dt>
<dd>Feature matrix.</dd>
<dt>regression_targets: dict</dt>
<dd>Mapping from <code class="docutils literal notranslate"><span class="pre">index_col</span></code> to regression target, e.g. LTV of user.</dd>
</dl>
<p>List of targets alligned to feature matrix indices</p>
</dd></dl>

<dl class="method">
<dt id="retentioneering.core.utils.BaseDataset.pairwise_time_distribution">
<code class="descname">pairwise_time_distribution</code><span class="sig-paren">(</span><em>event_order</em>, <em>time_col=None</em>, <em>index_col=None</em>, <em>event_col=None</em>, <em>bins=100</em>, <em>limit=180</em>, <em>topk=3</em><span class="sig-paren">)</span><a class="headerlink" href="#retentioneering.core.utils.BaseDataset.pairwise_time_distribution" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="retentioneering.core.utils.BaseDataset.prepare">
<code class="descname">prepare</code><span class="sig-paren">(</span><em>first_event=None</em><span class="sig-paren">)</span><a class="headerlink" href="#retentioneering.core.utils.BaseDataset.prepare" title="Permalink to this definition">¶</a></dt>
<dd><p>Populates dataset with target events based on target event description in <code class="docutils literal notranslate"><span class="pre">retention_config</span></code>.</p>
<dl class="docutils">
<dt>first_event: str, optional</dt>
<dd>If not <code class="docutils literal notranslate"><span class="pre">None</span></code>, then adds <code class="docutils literal notranslate"><span class="pre">first_event</span></code> for each <code class="docutils literal notranslate"><span class="pre">index_col</span></code> as a fist event in trajectory. Default: <code class="docutils literal notranslate"><span class="pre">None</span></code></dd>
</dl>
<p>Populates dataset with target events.</p>
</dd></dl>

<dl class="method">
<dt id="retentioneering.core.utils.BaseDataset.remove_events">
<code class="descname">remove_events</code><span class="sig-paren">(</span><em>event_list</em>, <em>mode='equal'</em><span class="sig-paren">)</span><a class="headerlink" href="#retentioneering.core.utils.BaseDataset.remove_events" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes events from dataset.</p>
<dl class="docutils">
<dt>event_list: list or str</dt>
<dd>Events or other elements of <code class="docutils literal notranslate"><span class="pre">event_col</span></code> that should be filtered out.</dd>
<dt>mode: str, optional</dt>
<dd><dl class="first last docutils">
<dt>Type of comparison:</dt>
<dd><ul class="first last simple">
<li><cite>equal</cite>: full event name match with element from <code class="docutils literal notranslate"><span class="pre">event_list</span></code>;</li>
<li><cite>startswith</cite>: event name starts with element from <code class="docutils literal notranslate"><span class="pre">event_list</span></code>;</li>
<li><cite>contains</cite>: event name contains element from <code class="docutils literal notranslate"><span class="pre">event_list</span></code>.</li>
</ul>
</dd>
</dl>
</dd>
</dl>
<p>Filtered dataframe based on event names.</p>
<p>pd.DataFrame</p>
</dd></dl>

<dl class="method">
<dt id="retentioneering.core.utils.BaseDataset.select_bbox_from_tsne">
<code class="descname">select_bbox_from_tsne</code><span class="sig-paren">(</span><em>bbox</em>, <em>plotting=True</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#retentioneering.core.utils.BaseDataset.select_bbox_from_tsne" title="Permalink to this definition">¶</a></dt>
<dd><p>Selects data filtered by cordinates of TSNE plot.</p>
<dl class="docutils">
<dt>bbox: list</dt>
<dd><dl class="first last docutils">
<dt>List of lists that contains angles of bbox.</dt>
<dd><dl class="first docutils">
<dt><a href="#id5"><span class="problematic" id="id6">``</span></a><a href="#id7"><span class="problematic" id="id8">`</span></a>bbox = [</dt>
<dd>[0, 0], # [min x, max x]
[10, 10] # [min y, max y]</dd>
</dl>
<p class="last">]```</p>
</dd>
</dl>
</dd>
<dt>plotting: bool, optional</dt>
<dd>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, then visualize graph of selected users.</dd>
</dl>
<p>Dataframe with filtered clickstream of users in bbox.</p>
<p>pd.DataFrame</p>
</dd></dl>

<dl class="method">
<dt id="retentioneering.core.utils.BaseDataset.show_tree_selector">
<code class="descname">show_tree_selector</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#retentioneering.core.utils.BaseDataset.show_tree_selector" title="Permalink to this definition">¶</a></dt>
<dd><p>Shows tree selector for event filtering, based on values in <code class="docutils literal notranslate"><span class="pre">event_col</span></code> column. It uses <cite>_</cite> for event splitting and aggregation, so ideally the event name structure in the dataset should include underscores, e.g. <code class="docutils literal notranslate"><span class="pre">[section]_[page]_[action]</span></code>. In this case event names are separated into levels, so that all the events with the same <code class="docutils literal notranslate"><span class="pre">[section]</span></code> will be placed under the same section, etc.
There two kind of checkboxes in IFrame: large blue and small white. The former are used to include or exclude event from original dataset. The latter are used for event aggregation: toggle on a checkbox to aggregate all the underlying events to this level.
Tree filter has a download button in the end of event list, which downloads a JSON config file, which you then need to use to filter and aggregate events with <code class="docutils literal notranslate"><span class="pre">BaseDataset.retention.use_tree_filter()</span></code> method.</p>
<dl class="docutils">
<dt>event_col: str, optional</dt>
<dd>Name of custom event column, for more information refer to <code class="docutils literal notranslate"><span class="pre">init_config</span></code>. For instance, you may want to aggregate some events or rename and use it as new event column. By default the column defined in <code class="docutils literal notranslate"><span class="pre">init_config</span></code> will be used as <code class="docutils literal notranslate"><span class="pre">event_col</span></code>.</dd>
<dt>width: int, optional</dt>
<dd>Width of IFrame object with filters.</dd>
<dt>height: int, optional</dt>
<dd>Height of IFrame object with filters.</dd>
</dl>
<p>Renders events tree selector</p>
<p>IFrame</p>
</dd></dl>

<dl class="method">
<dt id="retentioneering.core.utils.BaseDataset.step_matrix_bootstrap">
<code class="descname">step_matrix_bootstrap</code><span class="sig-paren">(</span><em>n_samples=10</em>, <em>sample_size=None</em>, <em>sample_rate=1</em>, <em>random_state=0</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#retentioneering.core.utils.BaseDataset.step_matrix_bootstrap" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimates means and standard deviations of step matrix values with bootstrap.</p>
<dl class="docutils">
<dt>n_samples: int, optional</dt>
<dd>Number of samples for bootstrap. Default: <code class="docutils literal notranslate"><span class="pre">10</span></code></dd>
<dt>sample_size: int, optional</dt>
<dd>Size of each subsample. Default: <code class="docutils literal notranslate"><span class="pre">None</span></code></dd>
<dt>sample_rate: float, optional</dt>
<dd>Rate of each subsample. Note that it cannot be used with <code class="docutils literal notranslate"><span class="pre">sample_size</span></code>. Default: <code class="docutils literal notranslate"><span class="pre">1</span></code></dd>
<dt>random_state: int, optional</dt>
<dd>Random state for sampling. Default: <code class="docutils literal notranslate"><span class="pre">0</span></code></dd>
<dt>kwargs: optional</dt>
<dd>Arguments of <code class="docutils literal notranslate"><span class="pre">BaseDataset.retention.get_step_matrix()</span></code></dd>
</dl>
<p>Two dataframes: with mean and standard deviation values.</p>
<p>pd.DataFrame</p>
</dd></dl>

<dl class="method">
<dt id="retentioneering.core.utils.BaseDataset.survival_curves">
<code class="descname">survival_curves</code><span class="sig-paren">(</span><em>groups</em>, <em>spec_event=None</em>, <em>time_min=None</em>, <em>time_max=None</em>, <em>event_col=None</em>, <em>index_col=None</em>, <em>target_event=None</em>, <em>time_step='D'</em>, <em>plotting=True</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#retentioneering.core.utils.BaseDataset.survival_curves" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot survival curves for given grouping.</p>
<dl class="docutils">
<dt>groups: np.array</dt>
<dd>Array of clickstream shape that splits data into different groups.</dd>
<dt>spec_event: str, optional</dt>
<dd>Event specific for test, e.g. we change auth flow, so we need to compare only users, who have started authorization, in this case <cite>spec_event=’auth_start’</cite>. Default: <code class="docutils literal notranslate"><span class="pre">None</span></code></dd>
<dt>time_min: int, optional</dt>
<dd>Time when A/B test was started. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, then whole dataset is used. Defaul: <code class="docutils literal notranslate"><span class="pre">None</span></code></dd>
<dt>time_max: int, optional</dt>
<dd>Time when A/B test was ended. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, then whole dataset is used. Default: <code class="docutils literal notranslate"><span class="pre">None</span></code></dd>
<dt>index_col: str, optional</dt>
<dd>Name of custom index column, for more information refer to <code class="docutils literal notranslate"><span class="pre">init_config</span></code>. For instance, if in config you have defined <code class="docutils literal notranslate"><span class="pre">index_col</span></code> as <code class="docutils literal notranslate"><span class="pre">user_id</span></code>, but want to use function over sessions. By default the column defined in <code class="docutils literal notranslate"><span class="pre">init_config</span></code> will be used as <code class="docutils literal notranslate"><span class="pre">index_col</span></code>.</dd>
<dt>event_col: str, optional</dt>
<dd>Name of custom event column, for more information refer to <code class="docutils literal notranslate"><span class="pre">init_config</span></code>. For instance, you may want to aggregate some events or rename and use it as new event column. By default the column defined in <code class="docutils literal notranslate"><span class="pre">init_config</span></code> will be used as <code class="docutils literal notranslate"><span class="pre">event_col</span></code>.</dd>
<dt>target_event: str, optional</dt>
<dd>Name of target event. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, then taken from <code class="docutils literal notranslate"><span class="pre">retention_config</span></code>. Default: <code class="docutils literal notranslate"><span class="pre">None</span></code></dd>
<dt>time_step: str, optional</dt>
<dd><dl class="first docutils">
<dt>Time step for calculation of survival rate at specific time.</dt>
<dd><dl class="first last docutils">
<dt>Possible options:</dt>
<dd><dl class="first last docutils">
<dt>(<cite>‘D’</cite> – day, <cite>‘M’</cite> – month, <cite>‘h’</cite> – hour, <cite>‘m’</cite> – minute, <cite>‘Y’</cite> – year,</dt>
<dd><cite>‘W’</cite> – week, <cite>‘s’</cite> – seconds, <cite>‘ms’</cite> – milliseconds).</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
<p class="last">Default is day (<cite>‘D’</cite>).</p>
</dd>
<dt>plotting: bool, optional</dt>
<dd>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, then plots survival curves.</dd>
</dl>
<p>Dataframe with points at survival curves and prints chi-squared LogRank test for equality statistics.</p>
<p>pd.DataFrame</p>
</dd></dl>

<dl class="method">
<dt id="retentioneering.core.utils.BaseDataset.use_tree_filter">
<code class="descname">use_tree_filter</code><span class="sig-paren">(</span><em>path</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#retentioneering.core.utils.BaseDataset.use_tree_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Uses generated with <code class="docutils literal notranslate"><span class="pre">show_tree_filter()</span></code> JSON config to filter and aggregate <code class="docutils literal notranslate"><span class="pre">event_col</span></code> values of dataset.</p>
<dl class="docutils">
<dt>path: str</dt>
<dd>Path to JSON config file generated with <code class="docutils literal notranslate"><span class="pre">show_tree_filter()</span></code> method.</dd>
</dl>
<p>Filtered and aggregated dataset</p>
<p>pd.DataFrame</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="retentioneering.core.utils.BaseTrajectory">
<em class="property">class </em><code class="descclassname">retentioneering.core.utils.</code><code class="descname">BaseTrajectory</code><span class="sig-paren">(</span><em>pandas_obj</em><span class="sig-paren">)</span><a class="headerlink" href="#retentioneering.core.utils.BaseTrajectory" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Trajectory is the basic object in Retentioneering. It is a dataframe consisting of at least three columns which should be reflected in <code class="docutils literal notranslate"><span class="pre">init_cofig</span></code>: index, event and timestamp.</p>
<dl class="staticmethod">
<dt id="retentioneering.core.utils.BaseTrajectory.calculate_node_metrics">
<em class="property">static </em><code class="descname">calculate_node_metrics</code><span class="sig-paren">(</span><em>metric_type='centrality'</em><span class="sig-paren">)</span><a class="headerlink" href="#retentioneering.core.utils.BaseTrajectory.calculate_node_metrics" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate metrics on graph</p>
<dl class="docutils">
<dt>metric_type: str, optional</dt>
<dd>Type of metrics, e.g. node centrality.</dd>
</dl>
<p>Nothing</p>
</dd></dl>

<dl class="method">
<dt id="retentioneering.core.utils.BaseTrajectory.get_adjacency">
<code class="descname">get_adjacency</code><span class="sig-paren">(</span><em>cols=None</em>, <em>edge_attributes='event_count'</em>, <em>norm=True</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#retentioneering.core.utils.BaseTrajectory.get_adjacency" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates edge graph in the matrix format. Basically this method is similar to <code class="docutils literal notranslate"><span class="pre">BaseTrajectory.retention.get_edgelist()</span></code> but in different format. Row indeces are <code class="docutils literal notranslate"><span class="pre">event_col</span></code> values, from which the transition occured, while the row names are <code class="docutils literal notranslate"><span class="pre">event_col</span></code> values, to which the transition occured. The values are weights of the edges defined with <code class="docutils literal notranslate"><span class="pre">edge_col</span></code>, <code class="docutils literal notranslate"><span class="pre">edge_attributes</span></code> and <code class="docutils literal notranslate"><span class="pre">norm</span></code> parameters.</p>
<dl class="docutils">
<dt>index_col: str, optional</dt>
<dd>Name of custom index column, for more information refer to <code class="docutils literal notranslate"><span class="pre">init_config</span></code>. For instance, if in config you have defined <code class="docutils literal notranslate"><span class="pre">index_col</span></code> as <code class="docutils literal notranslate"><span class="pre">user_id</span></code>, but want to use function over sessions. By default the column defined in <code class="docutils literal notranslate"><span class="pre">init_config</span></code> will be used as <code class="docutils literal notranslate"><span class="pre">index_col</span></code>.</dd>
<dt>event_col: str, optional</dt>
<dd>Name of custom event column, for more information refer to <code class="docutils literal notranslate"><span class="pre">init_config</span></code>. For instance, you may want to aggregate some events or rename and use it as new event column. By default the column defined in <code class="docutils literal notranslate"><span class="pre">init_config</span></code> will be used as <code class="docutils literal notranslate"><span class="pre">event_col</span></code>.</dd>
<dt>edge_col: str, optional</dt>
<dd>Aggregation column for edge weighting. For instance, you may set it to the same value as in <code class="docutils literal notranslate"><span class="pre">index_col</span></code> and define <code class="docutils literal notranslate"><span class="pre">edge_attributes='users_unique'</span></code> to calculate unique users passed through edge. Default: <code class="docutils literal notranslate"><span class="pre">None</span></code></dd>
<dt>edge_attributes: str, optional</dt>
<dd>Edge weighting function and the name of field is defined with this parameter. It is set with two parts and a dash inbetween: <code class="docutils literal notranslate"><span class="pre">[this_column_name]_[aggregation_function]</span></code>. The first part is the custom name of this field. The second part after <cite>_</cite> should be a valid <code class="docutils literal notranslate"><span class="pre">pandas.groupby.agg()</span></code> parameter, e.g. <code class="docutils literal notranslate"><span class="pre">count</span></code>, <code class="docutils literal notranslate"><span class="pre">sum</span></code>, <code class="docutils literal notranslate"><span class="pre">nunique</span></code>, etc. Default: <code class="docutils literal notranslate"><span class="pre">event_count</span></code>.</dd>
<dt>cols: list, optional</dt>
<dd>List of source and target columns, e.g. <code class="docutils literal notranslate"><span class="pre">event_name</span></code> and <code class="docutils literal notranslate"><span class="pre">next_event</span></code>. <code class="docutils literal notranslate"><span class="pre">next_event</span></code> column is created automatically during <code class="docutils literal notranslate"><span class="pre">BaseTrajectory.retention.prepare()</span></code> method execution. Default: <code class="docutils literal notranslate"><span class="pre">None</span></code> wich corresponds to <code class="docutils literal notranslate"><span class="pre">event_col</span></code> value from <code class="docutils literal notranslate"><span class="pre">retention_config</span></code> and ‘next_event’.</dd>
<dt>norm: bool, optional</dt>
<dd>Normalize values over aggregation used in the second part of <code class="docutils literal notranslate"><span class="pre">edge_attributes</span></code>. For example, if you set <code class="docutils literal notranslate"><span class="pre">edge_col='user_id'</span></code> and <code class="docutils literal notranslate"><span class="pre">edge_attributes='users_nunique'</span></code>, then if <code class="docutils literal notranslate"><span class="pre">norm=True</span></code>, edge values will be weighted by the unique number of users and will represent the percentage of unique users passed through a given edge. Default: <code class="docutils literal notranslate"><span class="pre">True</span></code>.</dd>
</dl>
<p>Dataframe with number of columns and rows equal to unique number of <code class="docutils literal notranslate"><span class="pre">event_col</span></code> values.</p>
<p>pd.DataFrame</p>
</dd></dl>

<dl class="method">
<dt id="retentioneering.core.utils.BaseTrajectory.get_edgelist">
<code class="descname">get_edgelist</code><span class="sig-paren">(</span><em>cols=None</em>, <em>edge_col=None</em>, <em>edge_attributes='event_count'</em>, <em>norm=True</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#retentioneering.core.utils.BaseTrajectory.get_edgelist" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates frequency table of the transitions between events.</p>
<dl class="docutils">
<dt>index_col: str, optional</dt>
<dd>Name of custom index column, for more information refer to <code class="docutils literal notranslate"><span class="pre">init_config</span></code>. For instance, if in config you have defined <code class="docutils literal notranslate"><span class="pre">index_col</span></code> as <code class="docutils literal notranslate"><span class="pre">user_id</span></code>, but want to use function over sessions. By default the column defined in <code class="docutils literal notranslate"><span class="pre">init_config</span></code> will be used as <code class="docutils literal notranslate"><span class="pre">index_col</span></code>.</dd>
<dt>event_col: str, optional</dt>
<dd>Name of custom event column, for more information refer to <code class="docutils literal notranslate"><span class="pre">init_config</span></code>. For instance, you may want to aggregate some events or rename and use it as new event column. By default the column defined in <code class="docutils literal notranslate"><span class="pre">init_config</span></code> will be used as <code class="docutils literal notranslate"><span class="pre">event_col</span></code>.</dd>
<dt>edge_col: str, optional</dt>
<dd>Aggregation column for edge weighting. For instance, you may set it to the same value as in <code class="docutils literal notranslate"><span class="pre">index_col</span></code> and define <code class="docutils literal notranslate"><span class="pre">edge_attributes='users_unique'</span></code> to calculate unique users passed through edge. Default: <code class="docutils literal notranslate"><span class="pre">None</span></code></dd>
<dt>edge_attributes: str, optional</dt>
<dd>Edge weighting function and the name of field is defined with this parameter. It is set with two parts and a dash inbetween: <code class="docutils literal notranslate"><span class="pre">[this_column_name]_[aggregation_function]</span></code>. The first part is the custom name of this field. The second part after <cite>_</cite> should be a valid <code class="docutils literal notranslate"><span class="pre">pandas.groupby.agg()</span></code> parameter, e.g. <code class="docutils literal notranslate"><span class="pre">count</span></code>, <code class="docutils literal notranslate"><span class="pre">sum</span></code>, <code class="docutils literal notranslate"><span class="pre">nunique</span></code>, etc. Default: <code class="docutils literal notranslate"><span class="pre">event_count</span></code>.</dd>
<dt>cols: list, optional</dt>
<dd>List of source and target columns, e.g. <code class="docutils literal notranslate"><span class="pre">event_name</span></code> and <code class="docutils literal notranslate"><span class="pre">next_event</span></code>. <code class="docutils literal notranslate"><span class="pre">next_event</span></code> column is created automatically during <code class="docutils literal notranslate"><span class="pre">BaseTrajectory.retention.prepare()</span></code> method execution. Default: <code class="docutils literal notranslate"><span class="pre">None</span></code> wich corresponds to <code class="docutils literal notranslate"><span class="pre">event_col</span></code> value from <code class="docutils literal notranslate"><span class="pre">retention_config</span></code> and ‘next_event’.</dd>
<dt>norm: bool, optional</dt>
<dd>Normalize <code class="docutils literal notranslate"><span class="pre">edge_col</span></code> values over aggregation used in the second part of <code class="docutils literal notranslate"><span class="pre">edge_attributes</span></code>. For example, if you set <code class="docutils literal notranslate"><span class="pre">edge_col='user_id'</span></code> and <code class="docutils literal notranslate"><span class="pre">edge_attributes='users_nunique'</span></code>, then if <code class="docutils literal notranslate"><span class="pre">norm=True</span></code>, edge values will be weighted by the unique number of users and will represent the percentage of unique users passed through a given edge. Default: <code class="docutils literal notranslate"><span class="pre">True</span></code>.</dd>
<dt>shift_name: str, optional</dt>
<dd>Name of column that contains next event of user.</dd>
</dl>
<p>Dataframe with number of rows equal to all edges with weight non-zero weight (max is squared number of unique <code class="docutils literal notranslate"><span class="pre">event_col</span></code> values) and the following column structure: <code class="docutils literal notranslate"><span class="pre">source_node</span></code>, <code class="docutils literal notranslate"><span class="pre">target_node</span></code> and <code class="docutils literal notranslate"><span class="pre">edge_weight</span></code>.</p>
<p>pd.DataFrame</p>
</dd></dl>

<dl class="method">
<dt id="retentioneering.core.utils.BaseTrajectory.get_step_matrix">
<code class="descname">get_step_matrix</code><span class="sig-paren">(</span><em>max_steps=30</em>, <em>plot_type=True</em>, <em>sorting=True</em>, <em>cols=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#retentioneering.core.utils.BaseTrajectory.get_step_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots heatmap with distribution of users over session steps ordered by event name. Matrix rows are event names, columns are aligned user trajectory step numbers and the values are shares of users. A given entry means that at a particular number step x% of users encountered a specific event.</p>
<dl class="docutils">
<dt>max_steps: int, optional</dt>
<dd>Maximum number of steps in trajectory to include. Depending on <code class="docutils literal notranslate"><span class="pre">reverse</span></code> parameter value, the steps are counted from the beginning of trajectories if <code class="docutils literal notranslate"><span class="pre">reverse=False</span></code>, or from the end otherwise.</dd>
<dt>plot_type: bool, optional</dt>
<dd>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, then plots step matrix in interactive session (Jupyter notebook). Default: <code class="docutils literal notranslate"><span class="pre">True</span></code></dd>
<dt>thr: float, optional</dt>
<dd>Used to prune matrix and display only the rows with at least one value &gt;= <code class="docutils literal notranslate"><span class="pre">thr</span></code>. Default: <code class="docutils literal notranslate"><span class="pre">None</span></code></dd>
<dt>reverse: str or list, optional</dt>
<dd><p class="first">This parameter is used to display reversed matrix from target events towards the beginning of trajectories.
Range of possible values:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">None</span></code>: displays default step matrix from the start of trajectories. Uses all the user trajectories.</li>
<li><code class="docutils literal notranslate"><span class="pre">'pos'</span></code>: displays reverse step matrix in such a way that the first column is the <code class="docutils literal notranslate"><span class="pre">positive_target_event</span></code> share, which is always 1, and the following columns reflect the share of users on final steps before reaching the target. Uses only those trajectories, which ended up having at least one <code class="docutils literal notranslate"><span class="pre">positive_target_event</span></code> in trajectory.</li>
<li><code class="docutils literal notranslate"><span class="pre">'neg'</span></code>: same as <code class="docutils literal notranslate"><span class="pre">pos</span></code> but for <code class="docutils literal notranslate"><span class="pre">negative_target_event</span></code>. Uses only those trajectories, which ended up having at least one <code class="docutils literal notranslate"><span class="pre">negative_target_event</span></code> in trajectory.</li>
<li><code class="docutils literal notranslate"><span class="pre">['pos',</span> <span class="pre">'neg']</span></code>: combination of <code class="docutils literal notranslate"><span class="pre">pos</span></code> and <code class="docutils literal notranslate"><span class="pre">neg</span></code> options, first column has only target events. Uses all the trajectories with target events inside.</li>
</ul>
</div></blockquote>
<p class="last">Default: <code class="docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
<dt>sorting: bool, optional</dt>
<dd>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, then automatically places elements with highest values in top. Rows are sorted in such a way that the first one has highest first column value, second row has the highest second column value,besides already used first value, etc. With this sorting you may see a dominant trajectory as a diagonal. Default: <code class="docutils literal notranslate"><span class="pre">True</span></code></dd>
<dt>index_col: str, optional</dt>
<dd>Name of custom index column, for more information refer to <code class="docutils literal notranslate"><span class="pre">init_config</span></code>. For instance, if in config you have defined <code class="docutils literal notranslate"><span class="pre">index_col</span></code> as <code class="docutils literal notranslate"><span class="pre">user_id</span></code>, but want to use function over sessions. By default the column defined in <code class="docutils literal notranslate"><span class="pre">init_config</span></code> will be used as <code class="docutils literal notranslate"><span class="pre">index_col</span></code>.</dd>
<dt>event_col: str, optional</dt>
<dd>Name of custom event column, for more information refer to <code class="docutils literal notranslate"><span class="pre">init_config</span></code>. For instance, you may want to aggregate some events or rename and use it as new event column. By default the column defined in <code class="docutils literal notranslate"><span class="pre">init_config</span></code> will be used as <code class="docutils literal notranslate"><span class="pre">event_col</span></code>.</dd>
<dt>cols: list, optional</dt>
<dd>List of source and target columns, e.g. <code class="docutils literal notranslate"><span class="pre">event_name</span></code> and <code class="docutils literal notranslate"><span class="pre">next_event</span></code>. <code class="docutils literal notranslate"><span class="pre">next_event</span></code> column is created automatically during <code class="docutils literal notranslate"><span class="pre">BaseTrajectory.retention.prepare()</span></code> method execution. Default: <code class="docutils literal notranslate"><span class="pre">None</span></code> wich corresponds to <code class="docutils literal notranslate"><span class="pre">event_col</span></code> value from <code class="docutils literal notranslate"><span class="pre">retention_config</span></code> and ‘next_event’.</dd>
<dt>edge_col: str, optional</dt>
<dd>Aggregation column for edge weighting. For instance, you may set it to the same value as in <code class="docutils literal notranslate"><span class="pre">index_col</span></code> and define <code class="docutils literal notranslate"><span class="pre">edge_attributes='users_unique'</span></code> to calculate unique users passed through edge. Default: <code class="docutils literal notranslate"><span class="pre">None</span></code></dd>
<dt>edge_attributes: str, optional</dt>
<dd>Edge weighting function and the name of field is defined with this parameter. It is set with two parts and a dash inbetween: <code class="docutils literal notranslate"><span class="pre">[this_column_name]_[aggregation_function]</span></code>. The first part is the custom name of this field. The second part after <cite>_</cite> should be a valid <code class="docutils literal notranslate"><span class="pre">pandas.groupby.agg()</span></code> parameter, e.g. <code class="docutils literal notranslate"><span class="pre">count</span></code>, <code class="docutils literal notranslate"><span class="pre">sum</span></code>, <code class="docutils literal notranslate"><span class="pre">nunique</span></code>, etc. Default: <code class="docutils literal notranslate"><span class="pre">event_count</span></code>.</dd>
<dt>dt_means: bool, optional</dt>
<dd>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, adds mean time between events to step matrix. Default: <code class="docutils literal notranslate"><span class="pre">False</span></code></dd>
<dt>title: str, optional</dt>
<dd>Title for step matrix plot. Default: <code class="docutils literal notranslate"><span class="pre">''</span></code></dd>
</dl>
<p>Dataframe with <code class="docutils literal notranslate"><span class="pre">max_steps</span></code> number of columns and len(event_col.unique) number of rows at max, or less if used <code class="docutils literal notranslate"><span class="pre">thr</span></code> &gt; 0.</p>
<p>pd.DataFrame</p>
</dd></dl>

<dl class="method">
<dt id="retentioneering.core.utils.BaseTrajectory.plot_graph">
<code class="descname">plot_graph</code><span class="sig-paren">(</span><em>user_based=True</em>, <em>node_params=None</em>, <em>index_col=None</em>, <em>node_weights=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#retentioneering.core.utils.BaseTrajectory.plot_graph" title="Permalink to this definition">¶</a></dt>
<dd><p>Create interactive graph visualization. Each node is a unique <code class="docutils literal notranslate"><span class="pre">event_col</span></code> value, edges are transitions between events and edge weights are calculated metrics. By default, it is a percentage of unique users that have passed though a particular edge visualized with the edge thickness. Node sizes are  Graph loop is a transition to the same node, which may happen if users encountered multiple errors or made any action at least twice.
Graph nodes are movable on canvas which helps to visualize user trajectories but is also a cumbersome process to place all the nodes so it forms a story.
That is why IFrame object also has a download button. By pressing it, a JSON configuration file with all the node parameters is downloaded. It contains node names, their positions, relative sizes and types. It it used as <code class="docutils literal notranslate"><span class="pre">layout_dump</span></code> parameter for layout configuration. Finally, show weights toggle shows and hides edge weights.</p>
<dl class="docutils">
<dt>user_based: bool, optional</dt>
<dd>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, then edge weights are calculated as unique rate of users who went through them.
IMPORTANT: if you want to use edge weighting different to unique user number, you should turn this argument <code class="docutils literal notranslate"><span class="pre">False</span></code>. Default: <code class="docutils literal notranslate"><span class="pre">True</span></code></dd>
<dt>node_params: dict, optional</dt>
<dd><dl class="first docutils">
<dt>Event mapping describing which nodes or edges should be highlighted by different colors for better visualisation. Dictionary keys are <code class="docutils literal notranslate"><span class="pre">event_col</span></code> values, while keys have the following possible values:</dt>
<dd><ul class="first last simple">
<li><code class="docutils literal notranslate"><span class="pre">bad_target</span></code>: highlights node and all incoming edges with red color;</li>
<li><code class="docutils literal notranslate"><span class="pre">nice_target</span></code>: highlights node and all incoming edges with green color;</li>
<li><code class="docutils literal notranslate"><span class="pre">bad_node</span></code>: highlights node with red color;</li>
<li><code class="docutils literal notranslate"><span class="pre">nice_node</span></code>: highlights node with green color;</li>
<li><code class="docutils literal notranslate"><span class="pre">source</span></code>: highlights node and all outgoing edges with yellow color.</li>
</ul>
</dd>
</dl>
<p>Example <code class="docutils literal notranslate"><span class="pre">node_params</span></code> is shown below:
<a href="#id9"><span class="problematic" id="id10">``</span></a>`
{</p>
<blockquote>
<div>‘lost’: ‘bad_target’,
‘purchased’: ‘nice_target’,
‘onboarding_welcome_screen’: ‘source’,
‘choose_login_type’: ‘nice_node’,
‘accept_privacy_policy’: ‘bad_node’,</div></blockquote>
<p>If <code class="docutils literal notranslate"><span class="pre">node_params=None</span></code>, it will be constructed from <code class="docutils literal notranslate"><span class="pre">retention_config</span></code> variable, so that:
<a href="#id11"><span class="problematic" id="id12">``</span></a>`
{</p>
<blockquote>
<div>‘positive_target_event’: ‘nice_target’,
‘negative_target_event’: ‘bad_target’,
‘source_event’: ‘source’,</div></blockquote>
<p class="last">Default: <code class="docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
<dt>thresh: float, optional</dt>
<dd>Minimal edge weight value to be rendered on a graph. If a node has no edges of the weight &gt;= <code class="docutils literal notranslate"><span class="pre">thresh</span></code>, then it is not shown on a graph. It is used to filter out rare event and not to clutter visualization. If you want to preserve some of the nodes regardless of <code class="docutils literal notranslate"><span class="pre">thresh</span></code> value, please use <code class="docutils literal notranslate"><span class="pre">targets</span></code> parameter. Default: <code class="docutils literal notranslate"><span class="pre">0.05</span></code></dd>
<dt>targets: list, optional</dt>
<dd>List of nodes which will ignore <code class="docutils literal notranslate"><span class="pre">thresh</span></code> parameter.</dd>
<dt>show_percent: bool, optional</dt>
<dd>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, then all edge weights are converted to percents by multiplying by 100 and adding percentage sign. Default: <code class="docutils literal notranslate"><span class="pre">True</span></code></dd>
<dt>interactive: bool, optional</dt>
<dd>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, then plots graph visualization in interactive session (Jupyter notebook). Default: <code class="docutils literal notranslate"><span class="pre">True</span></code></dd>
<dt>layout_dump: str, optional</dt>
<dd>Path to layout configuration file relative to current directory. If defined, uses configuration file as a graph layout. Default: <code class="docutils literal notranslate"><span class="pre">None</span></code></dd>
<dt>width: int, optional</dt>
<dd>Width of plot in pixels. Default: <code class="docutils literal notranslate"><span class="pre">500</span></code></dd>
<dt>height: int, optional</dt>
<dd>Height of plot in pixels. Default: <code class="docutils literal notranslate"><span class="pre">500</span></code></dd>
<dt>kwargs: optional</dt>
<dd>Other parameters for <code class="docutils literal notranslate"><span class="pre">BaseTrajectory.retention.get_edgelist()</span></code></dd>
</dl>
<p>Plots IFrame graph of <code class="docutils literal notranslate"><span class="pre">width</span></code> and <code class="docutils literal notranslate"><span class="pre">height</span></code> size.
Saves webpage with JS graph visualization to <code class="docutils literal notranslate"><span class="pre">retention_config.experiments_folder</span></code>.</p>
<p>Renders IFrame object in case of <code class="docutils literal notranslate"><span class="pre">interactive=True</span></code> and saves graph visualization as HTML in <code class="docutils literal notranslate"><span class="pre">experiments_folder</span></code> of <code class="docutils literal notranslate"><span class="pre">retention_config</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="retentioneering.core.utils.BaseTrajectory.split_sessions">
<code class="descname">split_sessions</code><span class="sig-paren">(</span><em>by_event=None</em>, <em>minimal_thresh=30</em><span class="sig-paren">)</span><a class="headerlink" href="#retentioneering.core.utils.BaseTrajectory.split_sessions" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates <code class="docutils literal notranslate"><span class="pre">session</span></code> column with session rank for each <code class="docutils literal notranslate"><span class="pre">index_col</span></code> based on time difference between events or on specific event.</p>
<dl class="docutils">
<dt>by_event: str, optional</dt>
<dd>If <code class="docutils literal notranslate"><span class="pre">None</span></code>, sessions are automatically defined with time diffrence between events, else splits sessions by specific event in <code class="docutils literal notranslate"><span class="pre">event_col</span></code>. For instance, if you have a technical event in your dataset defining a new user session, you may specify it in <code class="docutils literal notranslate"><span class="pre">by_event</span></code> to split sessions based on this event. Default: <code class="docutils literal notranslate"><span class="pre">None</span></code></dd>
<dt>minimal_thresh: int, optional</dt>
<dd>Minimal threshold in seconds between two sessions. Default: <code class="docutils literal notranslate"><span class="pre">30</span></code></dd>
</dl>
<p>Creates <code class="docutils literal notranslate"><span class="pre">session</span></code> column in dataset.</p>
<p>pd.DataFrame</p>
</dd></dl>

<dl class="method">
<dt id="retentioneering.core.utils.BaseTrajectory.weight_by_mechanics">
<code class="descname">weight_by_mechanics</code><span class="sig-paren">(</span><em>main_event_map</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#retentioneering.core.utils.BaseTrajectory.weight_by_mechanics" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates weights of mechanics over <code class="docutils literal notranslate"><span class="pre">index_col</span></code>.</p>
<dl class="docutils">
<dt>main_event_map:</dt>
<dd>Mapping of main events into mechanics.</dd>
<dt>kwargs:</dt>
<dd><code class="docutils literal notranslate"><span class="pre">sklearn.decomposition.LatentDirichletAllocation()</span></code> and <code class="docutils literal notranslate"><span class="pre">BaseDataset.retention.extract_features()</span></code> parameters.</dd>
</dl>
<p>Weights of mechanics for each <code class="docutils literal notranslate"><span class="pre">index_col</span></code> and mechanics description.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="retentioneering.core.utils.init_config">
<code class="descclassname">retentioneering.core.utils.</code><code class="descname">init_config</code><span class="sig-paren">(</span><em>**config</em><span class="sig-paren">)</span><a class="headerlink" href="#retentioneering.core.utils.init_config" title="Permalink to this definition">¶</a></dt>
<dd><p>Primary method that defines the configuration of the analysis with Retentioneering library. It is mandatory to initialize or update config and pandas accessors with this method before moving on to any other method.</p>
<dl class="docutils">
<dt>index_col: str</dt>
<dd>Dataframe index column name (e.g. <cite>user_pseudo_id</cite> in our examples). Index column is the ID of trajectory which is a series of events or states happening at given times. Index column separates your dataset by users or sessions, etc. The most common ones are user or session columns. If you have a default dataset with user_id, event_name and timestamp columns, and want to use session as an index column, please use <code class="docutils literal notranslate"><span class="pre">retentioneering.core.preprocessing.split_sessions</span></code> method to generate pseudosessions.</dd>
<dt>event_col: str</dt>
<dd>Dataframe column name in which all the event names are stored (e.g. <cite>event_name</cite> in our examples).</dd>
<dt>event_time_col: str</dt>
<dd>Dataframe column name with timestamp values of the corresponding events (e.g. <cite>event_timestamp</cite> in our examples). The values in this column should be integer or float types (in the latter case, they will be rounded to integer).</dd>
<dt>positive_target_event: str</dt>
<dd><dl class="first last docutils">
<dt>Name of positive target event. There are two options to define this parameter:</dt>
<dd><ul class="first last simple">
<li>Real value which exists explicitly at least once in <code class="docutils literal notranslate"><span class="pre">event_col</span></code> of the dataframe. In this case there is no need to define <code class="docutils literal notranslate"><span class="pre">pos_target_event</span></code>. For instance, you have a <code class="docutils literal notranslate"><span class="pre">purchase</span></code> value inside <code class="docutils literal notranslate"><span class="pre">event_col</span></code> which you would like to use as positive target. In this case, you should define <code class="docutils literal notranslate"><span class="pre">positive_target_event</span> <span class="pre">=</span> <span class="pre">'purchase'</span></code> and not define <code class="docutils literal notranslate"><span class="pre">pos_target_definition</span></code>.</li>
<li>Preferred alias of positive target which is implicitly generated according to logic stated in <code class="docutils literal notranslate"><span class="pre">pos_target_definition</span></code>. In this case it is obligatory to define <code class="docutils literal notranslate"><span class="pre">pos_target_definition</span></code>. For instance, you have <code class="docutils literal notranslate"><span class="pre">thank_you</span></code> and <code class="docutils literal notranslate"><span class="pre">order_received</span></code> events inside <code class="docutils literal notranslate"><span class="pre">event_col</span></code> which both mean successful purchase. In this case, you define <code class="docutils literal notranslate"><span class="pre">positive_target_event</span> <span class="pre">=</span> <span class="pre">'purchase'</span></code> and <code class="docutils literal notranslate"><span class="pre">pos_target_definition={event_list=['thank_you',</span> <span class="pre">'order_received']}</span></code>.</li>
</ul>
</dd>
</dl>
</dd>
<dt>negative_target_event: str</dt>
<dd>Name of negative target event. Similar to <code class="docutils literal notranslate"><span class="pre">positive_target_event</span></code>.</dd>
<dt>pos_target_definition: dict, optional</dt>
<dd><dl class="first last docutils">
<dt>If not defined:</dt>
<dd><code class="docutils literal notranslate"><span class="pre">positive_target_event</span></code> is taken as positive target and it should be present in <code class="docutils literal notranslate"><span class="pre">event_col</span></code> at least once. If it is not present, the future analysis will be carried on without positive target events.</dd>
<dt>If defined:</dt>
<dd><ul class="first last simple">
<li>As empty dict, then adds <cite>positive_target_event</cite> for users or sessions depending on <code class="docutils literal notranslate"><span class="pre">index_col</span></code>, who do not have <code class="docutils literal notranslate"><span class="pre">negative_target_event</span></code> anywhere in the trajectory.</li>
<li>If contains <code class="docutils literal notranslate"><span class="pre">time_limit</span></code> (int, optional), then adds event to session after <code class="docutils literal notranslate"><span class="pre">time_limit</span></code> seconds of inactivity. Positive target event will be populated for each <code class="docutils literal notranslate"><span class="pre">index_col</span></code> whose last event happened at least <code class="docutils literal notranslate"><span class="pre">time_limit</span></code> seconds before <code class="docutils literal notranslate"><span class="pre">max(event_time_col)</span></code> and in absence of <code class="docutils literal notranslate"><span class="pre">neg_target_event</span></code> explicitly present in <code class="docutils literal notranslate"><span class="pre">event_col</span></code>.</li>
<li>If contains <code class="docutils literal notranslate"><span class="pre">event_list</span></code> (str or dict, optional), then replaces events in list with <code class="docutils literal notranslate"><span class="pre">positive_target_event</span></code>. It is used when you want to combine several positive target events with one name.</li>
<li>Note that either <code class="docutils literal notranslate"><span class="pre">time_limit</span></code> or <code class="docutils literal notranslate"><span class="pre">event_list</span></code> should be defined, not both.</li>
</ul>
</dd>
</dl>
</dd>
<dt>neg_target_definition: dict, optional</dt>
<dd>Similar to <code class="docutils literal notranslate"><span class="pre">pos_target_definition</span></code>, but applied to <code class="docutils literal notranslate"><span class="pre">negative_target_event</span></code>. If both <code class="docutils literal notranslate"><span class="pre">pos_target_definition</span></code> and <code class="docutils literal notranslate"><span class="pre">neg_target_definition</span></code> are used, then in order to successfully populate the dataset, the definitions should be noncontradictory. Firstly, non-empty dictionaries are executed, then empty.</dd>
<dt>experiments_folder: str, optional</dt>
<dd>Folder name in current working directory where the attachments will be saved. If not stated, then folder with current timestamp as a name will be created.</dd>
<dt>source_event: str, optional</dt>
<dd>Name of starting event of user session or trajectory. Used in graph visuatization by accenting color of the edges starting from <code class="docutils literal notranslate"><span class="pre">source_event</span></code> with yellow.</dd>
</dl>
<p>Updates or creates <code class="docutils literal notranslate"><span class="pre">retention_config</span></code> dict variable with defined values.</p>
</dd></dl>

</div>
<div class="section" id="module-retentioneering.core">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-retentioneering.core" title="Permalink to this headline">¶</a></h2>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="retentioneering.visualization.html" class="btn btn-neutral float-right" title="retentioneering.visualization package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="retentioneering.html" class="btn btn-neutral float-left" title="retentioneering package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Retentioneering User Trajectory Analysis Lab

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
    <br><br>More information about our services at <a href="https://retentioneering.com/">Retentioneering.com</a>.


</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>